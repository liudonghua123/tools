import{u as Re,r as I,o as Ie,c as E,j as A,d as w,g as se,t as C,e as K,h as Ce,q as Se,n as we,i as Oe,b as Fe,F as Ve,f as je}from"./index-DDXOat2P.js";import Me from"./MonacoEditor-NmHOSzWw.js";import"./monaco-editor-CGO6wXTd.js";const ie=0,oe=1,y=0,h=8,te=20,G=28,be=31,Pe=37,M=44,We=52,O=54,xe=55,b=58,de=63,ve=76,ce=64;class J{static read_bytes(e,r){const s=new J;return s.buf=e.getUint32(r,!0),s.buf_len=e.getUint32(r+4,!0),s}static read_bytes_array(e,r,s){const f=[];for(let t=0;t<s;t++)f.push(J.read_bytes(e,r+8*t));return f}}class Q{static read_bytes(e,r){const s=new Q;return s.buf=e.getUint32(r,!0),s.buf_len=e.getUint32(r+4,!0),s}static read_bytes_array(e,r,s){const f=[];for(let t=0;t<s;t++)f.push(Q.read_bytes(e,r+8*t));return f}}const He=0,Ge=1,Te=2,Ue=2,z=3,re=4;class ae{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,r){e.setBigUint64(r,this.d_next,!0),e.setBigUint64(r+8,this.d_ino,!0),e.setUint32(r+16,this.dir_name.length,!0),e.setUint8(r+20,this.d_type)}write_name_bytes(e,r,s){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,s)),r)}constructor(e,r,s,f){const t=new TextEncoder().encode(s);this.d_next=e,this.d_ino=r,this.d_namlen=t.byteLength,this.d_type=f,this.dir_name=t}}const Ye=1;class he{write_bytes(e,r){e.setUint8(r,this.fs_filetype),e.setUint16(r+2,this.fs_flags,!0),e.setBigUint64(r+8,this.fs_rights_base,!0),e.setBigUint64(r+16,this.fs_rights_inherited,!0)}constructor(e,r){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=r}}const le=1,X=2,ke=4,Be=8;class pe{write_bytes(e,r){e.setBigUint64(r,this.dev,!0),e.setBigUint64(r+8,this.ino,!0),e.setUint8(r+16,this.filetype),e.setBigUint64(r+24,this.nlink,!0),e.setBigUint64(r+32,this.size,!0),e.setBigUint64(r+38,this.atim,!0),e.setBigUint64(r+46,this.mtim,!0),e.setBigUint64(r+52,this.ctim,!0)}constructor(e,r,s){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=r,this.size=s}}const Ze=0,$e=1;class ge{static read_bytes(e,r){return new ge(e.getBigUint64(r,!0),e.getUint8(r+8),e.getUint32(r+16,!0),e.getBigUint64(r+24,!0),e.getUint16(r+36,!0))}constructor(e,r,s,f,t){this.userdata=e,this.eventtype=r,this.clockid=s,this.timeout=f,this.flags=t}}class qe{write_bytes(e,r){e.setBigUint64(r,this.userdata,!0),e.setUint16(r+8,this.error,!0),e.setUint8(r+10,this.eventtype)}constructor(e,r,s){this.userdata=e,this.error=r,this.eventtype=s}}const Ke=0;class Xe{write_bytes(e,r){e.setUint32(r,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}}class ye{static dir(e){const r=new ye;return r.tag=Ke,r.inner=new Xe(e),r}write_bytes(e,r){e.setUint32(r,this.tag,!0),this.inner.write_bytes(e,r+4)}}let Je=class{enable(e){this.log=Qe(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function Qe(x,e){return x?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const B=new Je(!1);class Ee extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let Ae=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(r){if(r instanceof Ee)return r.code;throw r}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,r,s,f={}){this.args=[],this.env=[],this.fds=[],B.enable(f.debug),this.args=e,this.env=r,this.fds=s;const t=this;this.wasiImport={args_sizes_get(n,i){const o=new DataView(t.inst.exports.memory.buffer);o.setUint32(n,t.args.length,!0);let a=0;for(const l of t.args)a+=l.length+1;return o.setUint32(i,a,!0),B.log(o.getUint32(n,!0),o.getUint32(i,!0)),0},args_get(n,i){const o=new DataView(t.inst.exports.memory.buffer),a=new Uint8Array(t.inst.exports.memory.buffer),l=i;for(let u=0;u<t.args.length;u++){o.setUint32(n,i,!0),n+=4;const d=new TextEncoder().encode(t.args[u]);a.set(d,i),o.setUint8(i+d.length,0),i+=d.length+1}return B.enabled&&B.log(new TextDecoder("utf-8").decode(a.slice(l,i))),0},environ_sizes_get(n,i){const o=new DataView(t.inst.exports.memory.buffer);o.setUint32(n,t.env.length,!0);let a=0;for(const l of t.env)a+=new TextEncoder().encode(l).length+1;return o.setUint32(i,a,!0),B.log(o.getUint32(n,!0),o.getUint32(i,!0)),0},environ_get(n,i){const o=new DataView(t.inst.exports.memory.buffer),a=new Uint8Array(t.inst.exports.memory.buffer),l=i;for(let u=0;u<t.env.length;u++){o.setUint32(n,i,!0),n+=4;const d=new TextEncoder().encode(t.env[u]);a.set(d,i),o.setUint8(i+d.length,0),i+=d.length+1}return B.enabled&&B.log(new TextDecoder("utf-8").decode(a.slice(l,i))),0},clock_res_get(n,i){let o;switch(n){case oe:{o=5000n;break}case ie:{o=1000000n;break}default:return We}return new DataView(t.inst.exports.memory.buffer).setBigUint64(i,o,!0),y},clock_time_get(n,i,o){const a=new DataView(t.inst.exports.memory.buffer);if(n===ie)a.setBigUint64(o,BigInt(new Date().getTime())*1000000n,!0);else if(n==oe){let l;try{l=BigInt(Math.round(performance.now()*1e6))}catch{l=0n}a.setBigUint64(o,l,!0)}else a.setBigUint64(o,0n,!0);return 0},fd_advise(n,i,o,a){return t.fds[n]!=null?y:h},fd_allocate(n,i,o){return t.fds[n]!=null?t.fds[n].fd_allocate(i,o):h},fd_close(n){if(t.fds[n]!=null){const i=t.fds[n].fd_close();return t.fds[n]=void 0,i}else return h},fd_datasync(n){return t.fds[n]!=null?t.fds[n].fd_sync():h},fd_fdstat_get(n,i){if(t.fds[n]!=null){const{ret:o,fdstat:a}=t.fds[n].fd_fdstat_get();return a!=null&&a.write_bytes(new DataView(t.inst.exports.memory.buffer),i),o}else return h},fd_fdstat_set_flags(n,i){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_flags(i):h},fd_fdstat_set_rights(n,i,o){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_rights(i,o):h},fd_filestat_get(n,i){if(t.fds[n]!=null){const{ret:o,filestat:a}=t.fds[n].fd_filestat_get();return a!=null&&a.write_bytes(new DataView(t.inst.exports.memory.buffer),i),o}else return h},fd_filestat_set_size(n,i){return t.fds[n]!=null?t.fds[n].fd_filestat_set_size(i):h},fd_filestat_set_times(n,i,o,a){return t.fds[n]!=null?t.fds[n].fd_filestat_set_times(i,o,a):h},fd_pread(n,i,o,a,l){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const c=J.read_bytes_array(u,i,o);let p=0;for(const _ of c){const{ret:m,data:v}=t.fds[n].fd_pread(_.buf_len,a);if(m!=y)return u.setUint32(l,p,!0),m;if(d.set(v,_.buf),p+=v.length,a+=BigInt(v.length),v.length!=_.buf_len)break}return u.setUint32(l,p,!0),y}else return h},fd_prestat_get(n,i){const o=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:a,prestat:l}=t.fds[n].fd_prestat_get();return l!=null&&l.write_bytes(o,i),a}else return h},fd_prestat_dir_name(n,i,o){if(t.fds[n]!=null){const{ret:a,prestat:l}=t.fds[n].fd_prestat_get();if(l==null)return a;const u=l.inner.pr_name;return new Uint8Array(t.inst.exports.memory.buffer).set(u.slice(0,o),i),u.byteLength>o?Pe:y}else return h},fd_pwrite(n,i,o,a,l){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const c=Q.read_bytes_array(u,i,o);let p=0;for(const _ of c){const m=d.slice(_.buf,_.buf+_.buf_len),{ret:v,nwritten:N}=t.fds[n].fd_pwrite(m,a);if(v!=y)return u.setUint32(l,p,!0),v;if(p+=N,a+=BigInt(N),N!=m.byteLength)break}return u.setUint32(l,p,!0),y}else return h},fd_read(n,i,o,a){const l=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=J.read_bytes_array(l,i,o);let c=0;for(const p of d){const{ret:_,data:m}=t.fds[n].fd_read(p.buf_len);if(_!=y)return l.setUint32(a,c,!0),_;if(u.set(m,p.buf),c+=m.length,m.length!=p.buf_len)break}return l.setUint32(a,c,!0),y}else return h},fd_readdir(n,i,o,a,l){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){let c=0;for(;;){const{ret:p,dirent:_}=t.fds[n].fd_readdir_single(a);if(p!=0)return u.setUint32(l,c,!0),p;if(_==null)break;if(o-c<_.head_length()){c=o;break}const m=new ArrayBuffer(_.head_length());if(_.write_head_bytes(new DataView(m),0),d.set(new Uint8Array(m).slice(0,Math.min(m.byteLength,o-c)),i),i+=_.head_length(),c+=_.head_length(),o-c<_.name_length()){c=o;break}_.write_name_bytes(d,i,o-c),i+=_.name_length(),c+=_.name_length(),a=_.d_next}return u.setUint32(l,c,!0),0}else return h},fd_renumber(n,i){if(t.fds[n]!=null&&t.fds[i]!=null){const o=t.fds[i].fd_close();return o!=0?o:(t.fds[i]=t.fds[n],t.fds[n]=void 0,0)}else return h},fd_seek(n,i,o,a){const l=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:u,offset:d}=t.fds[n].fd_seek(i,o);return l.setBigInt64(a,d,!0),u}else return h},fd_sync(n){return t.fds[n]!=null?t.fds[n].fd_sync():h},fd_tell(n,i){const o=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:a,offset:l}=t.fds[n].fd_tell();return o.setBigUint64(i,l,!0),a}else return h},fd_write(n,i,o,a){const l=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=Q.read_bytes_array(l,i,o);let c=0;for(const p of d){const _=u.slice(p.buf,p.buf+p.buf_len),{ret:m,nwritten:v}=t.fds[n].fd_write(_);if(m!=y)return l.setUint32(a,c,!0),m;if(c+=v,v!=_.byteLength)break}return l.setUint32(a,c,!0),y}else return h},path_create_directory(n,i,o){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(i,i+o));return t.fds[n].path_create_directory(l)}else return h},path_filestat_get(n,i,o,a,l){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const c=new TextDecoder("utf-8").decode(d.slice(o,o+a)),{ret:p,filestat:_}=t.fds[n].path_filestat_get(i,c);return _!=null&&_.write_bytes(u,l),p}else return h},path_filestat_set_times(n,i,o,a,l,u,d){const c=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(c.slice(o,o+a));return t.fds[n].path_filestat_set_times(i,p,l,u,d)}else return h},path_link(n,i,o,a,l,u,d){const c=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[l]!=null){const p=new TextDecoder("utf-8").decode(c.slice(o,o+a)),_=new TextDecoder("utf-8").decode(c.slice(u,u+d)),{ret:m,inode_obj:v}=t.fds[n].path_lookup(p,i);return v==null?m:t.fds[l].path_link(_,v,!1)}else return h},path_open(n,i,o,a,l,u,d,c,p){const _=new DataView(t.inst.exports.memory.buffer),m=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const v=new TextDecoder("utf-8").decode(m.slice(o,o+a));B.log(v);const{ret:N,fd_obj:U}=t.fds[n].path_open(i,v,l,u,d,c);if(N!=0)return N;t.fds.push(U);const g=t.fds.length-1;return _.setUint32(p,g,!0),0}else return h},path_readlink(n,i,o,a,l,u){const d=new DataView(t.inst.exports.memory.buffer),c=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(c.slice(i,i+o));B.log(p);const{ret:_,data:m}=t.fds[n].path_readlink(p);if(m!=null){const v=new TextEncoder().encode(m);if(v.length>l)return d.setUint32(u,0,!0),h;c.set(v,a),d.setUint32(u,v.length,!0)}return _}else return h},path_remove_directory(n,i,o){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(i,i+o));return t.fds[n].path_remove_directory(l)}else return h},path_rename(n,i,o,a,l,u){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[a]!=null){const c=new TextDecoder("utf-8").decode(d.slice(i,i+o)),p=new TextDecoder("utf-8").decode(d.slice(l,l+u));let{ret:_,inode_obj:m}=t.fds[n].path_unlink(c);if(m==null)return _;if(_=t.fds[a].path_link(p,m,!0),_!=y&&t.fds[n].path_link(c,m,!0)!=y)throw"path_link should always return success when relinking an inode back to the original place";return _}else return h},path_symlink(n,i,o,a,l){const u=new Uint8Array(t.inst.exports.memory.buffer);return t.fds[o]!=null?(new TextDecoder("utf-8").decode(u.slice(n,n+i)),new TextDecoder("utf-8").decode(u.slice(a,a+l)),b):h},path_unlink_file(n,i,o){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(i,i+o));return t.fds[n].path_unlink_file(l)}else return h},poll_oneoff(n,i,o){if(o===0)return G;if(o>1)return B.log("poll_oneoff: only a single subscription is supported"),b;const a=new DataView(t.inst.exports.memory.buffer),l=ge.read_bytes(a,n),u=l.eventtype,d=l.clockid,c=l.timeout;if(u!==Ze)return B.log("poll_oneoff: only clock subscriptions are supported"),b;let p;if(d===oe)p=()=>BigInt(Math.round(performance.now()*1e6));else if(d===ie)p=()=>BigInt(new Date().getTime())*1000000n;else return G;const _=(l.flags&$e)!==0?c:p()+c;for(;_>p(););return new qe(l.userdata,y,u).write_bytes(a,i),y},proc_exit(n){throw new Ee(n)},proc_raise(n){throw"raised signal "+n},sched_yield(){},random_get(n,i){const o=new Uint8Array(t.inst.exports.memory.buffer).subarray(n,n+i);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(t.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let a=0;a<i;a+=65536)crypto.getRandomValues(o.subarray(a,a+65536));else for(let a=0;a<i;a++)o[a]=Math.random()*256|0},sock_recv(n,i,o){throw"sockets not supported"},sock_send(n,i,o){throw"sockets not supported"},sock_shutdown(n,i){throw"sockets not supported"},sock_accept(n,i){throw"sockets not supported"}}}};class me{fd_allocate(e,r){return b}fd_close(){return 0}fd_fdstat_get(){return{ret:b,fdstat:null}}fd_fdstat_set_flags(e){return b}fd_fdstat_set_rights(e,r){return b}fd_filestat_get(){return{ret:b,filestat:null}}fd_filestat_set_size(e){return b}fd_filestat_set_times(e,r,s){return b}fd_pread(e,r){return{ret:b,data:new Uint8Array}}fd_prestat_get(){return{ret:b,prestat:null}}fd_pwrite(e,r){return{ret:b,nwritten:0}}fd_read(e){return{ret:b,data:new Uint8Array}}fd_readdir_single(e){return{ret:b,dirent:null}}fd_seek(e,r){return{ret:b,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:b,offset:0n}}fd_write(e){return{ret:b,nwritten:0}}path_create_directory(e){return b}path_filestat_get(e,r){return{ret:b,filestat:null}}path_filestat_set_times(e,r,s,f,t){return b}path_link(e,r,s){return b}path_unlink(e){return{ret:b,inode_obj:null}}path_lookup(e,r){return{ret:b,inode_obj:null}}path_open(e,r,s,f,t,n){return{ret:O,fd_obj:null}}path_readlink(e){return{ret:b,data:null}}path_remove_directory(e){return b}path_rename(e,r,s){return b}path_unlink_file(e){return b}}class F{static issue_ino(){return F.next_ino++}static root_ino(){return 0n}constructor(){this.ino=F.issue_ino()}}F.next_ino=1n;class _e extends me{fd_allocate(e,r){if(!(this.file.size>e+r)){const s=new Uint8Array(Number(e+r));s.set(this.file.data,0),this.file.data=s}return y}fd_fdstat_get(){return{ret:0,fdstat:new he(re,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const r=new Uint8Array(Number(e));r.set(this.file.data,0),this.file.data=r}return y}fd_read(e){const r=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(r.length),{ret:0,data:r}}fd_pread(e,r){return{ret:0,data:this.file.data.slice(Number(r),Number(r+BigInt(e)))}}fd_seek(e,r){let s;switch(r){case He:s=e;break;case Ge:s=this.file_pos+e;break;case Te:s=BigInt(this.file.data.byteLength)+e;break;default:return{ret:G,offset:0n}}return s<0?{ret:G,offset:0n}:(this.file_pos=s,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:h,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(r)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,r){if(this.file.readonly)return{ret:h,nwritten:0};if(r+BigInt(e.byteLength)>this.file.size){const s=this.file.data;this.file.data=new Uint8Array(Number(r+BigInt(e.byteLength))),this.file.data.set(s)}return this.file.data.set(e,Number(r)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class Le extends me{fd_seek(e,r){return{ret:h,offset:0n}}fd_tell(){return{ret:h,offset:0n}}fd_allocate(e,r){return h}fd_fdstat_get(){return{ret:0,fdstat:new he(z,0)}}fd_readdir_single(e){if(B.enabled&&(B.log("readdir_single",e),B.log(e,this.dir.contents.keys())),e==0n)return{ret:y,dirent:new ae(1n,this.dir.ino,".",z)};if(e==1n)return{ret:y,dirent:new ae(2n,this.dir.parent_ino(),"..",z)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[r,s]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new ae(e+1n,s.ino,r,s.stat().filetype)}}path_filestat_get(e,r){const{ret:s,path:f}=S.from(r);if(f==null)return{ret:s,filestat:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(f);return n==null?{ret:t,filestat:null}:{ret:0,filestat:n.stat()}}path_lookup(e,r){const{ret:s,path:f}=S.from(e);if(f==null)return{ret:s,inode_obj:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(f);return n==null?{ret:t,inode_obj:null}:{ret:y,inode_obj:n}}path_open(e,r,s,f,t,n){const{ret:i,path:o}=S.from(r);if(o==null)return{ret:i,fd_obj:null};let{ret:a,entry:l}=this.dir.get_entry_for_path(o);if(l==null){if(a!=M)return{ret:a,fd_obj:null};if((s&le)==le){const{ret:u,entry:d}=this.dir.create_entry_for_path(r,(s&X)==X);if(d==null)return{ret:u,fd_obj:null};l=d}else return{ret:M,fd_obj:null}}else if((s&ke)==ke)return{ret:te,fd_obj:null};return(s&X)==X&&l.stat().filetype!==z?{ret:O,fd_obj:null}:l.path_open(s,f,n)}path_create_directory(e){return this.path_open(0,e,le|X,0n,0n,0).ret}path_link(e,r,s){const{ret:f,path:t}=S.from(e);if(t==null)return f;if(t.is_dir)return M;const{ret:n,parent_entry:i,filename:o,entry:a}=this.dir.get_parent_dir_and_entry_for_path(t,!0);if(i==null||o==null)return n;if(a!=null){const l=r.stat().filetype==z,u=a.stat().filetype==z;if(l&&u)if(s&&a instanceof L){if(a.contents.size!=0)return xe}else return te;else{if(l&&!u)return O;if(!l&&u)return be;if(!(r.stat().filetype==re&&a.stat().filetype==re))return te}}return!s&&r.stat().filetype==z?de:(i.contents.set(o,r),y)}path_unlink(e){const{ret:r,path:s}=S.from(e);if(s==null)return{ret:r,inode_obj:null};const{ret:f,parent_entry:t,filename:n,entry:i}=this.dir.get_parent_dir_and_entry_for_path(s,!0);return t==null||n==null?{ret:f,inode_obj:null}:i==null?{ret:M,inode_obj:null}:(t.contents.delete(n),{ret:y,inode_obj:i})}path_unlink_file(e){const{ret:r,path:s}=S.from(e);if(s==null)return r;const{ret:f,parent_entry:t,filename:n,entry:i}=this.dir.get_parent_dir_and_entry_for_path(s,!1);return t==null||n==null||i==null?f:i.stat().filetype===z?be:(t.contents.delete(n),y)}path_remove_directory(e){const{ret:r,path:s}=S.from(e);if(s==null)return r;const{ret:f,parent_entry:t,filename:n,entry:i}=this.dir.get_parent_dir_and_entry_for_path(s,!1);return t==null||n==null||i==null?f:!(i instanceof L)||i.stat().filetype!==z?O:i.contents.size!==0?xe:t.contents.delete(n)?y:M}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return h}fd_read(e){return{ret:h,data:new Uint8Array}}fd_pread(e,r){return{ret:h,data:new Uint8Array}}fd_write(e){return{ret:h,nwritten:0}}fd_pwrite(e,r){return{ret:h,nwritten:0}}constructor(e){super(),this.dir=e}}class ee extends Le{fd_prestat_get(){return{ret:0,prestat:ye.dir(this.prestat_name)}}constructor(e,r){super(new L(r)),this.prestat_name=e}}class W extends F{path_open(e,r,s){if(this.readonly&&(r&BigInt(ce))==BigInt(ce))return{ret:de,fd_obj:null};if((e&Be)==Be){if(this.readonly)return{ret:de,fd_obj:null};this.data=new Uint8Array([])}const f=new _e(this);return s&Ye&&f.fd_seek(0n,Te),{ret:y,fd_obj:f}}get size(){return BigInt(this.data.byteLength)}stat(){return new pe(this.ino,re,this.size)}constructor(e,r){super(),this.data=new Uint8Array(e),this.readonly=!!(r!=null&&r.readonly)}}let S=class Ne{static from(e){const r=new Ne;if(r.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:ve,path:null};if(e.includes("\0"))return{ret:G,path:null};for(const s of e.split("/"))if(!(s===""||s===".")){if(s===".."){if(r.parts.pop()==null)return{ret:ve,path:null};continue}r.parts.push(s)}return{ret:y,path:r}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}constructor(){this.parts=[],this.is_dir=!1}};class L extends F{parent_ino(){return this.parent==null?F.root_ino():this.parent.ino}path_open(e,r,s){return{ret:y,fd_obj:new Le(this)}}stat(){return new pe(this.ino,z,0n)}get_entry_for_path(e){let r=this;for(const s of e.parts){if(!(r instanceof L))return{ret:O,entry:null};const f=r.contents.get(s);if(f!==void 0)r=f;else return B.log(s),{ret:M,entry:null}}return e.is_dir&&r.stat().filetype!=z?{ret:O,entry:null}:{ret:y,entry:r}}get_parent_dir_and_entry_for_path(e,r){const s=e.parts.pop();if(s===void 0)return{ret:G,parent_entry:null,filename:null,entry:null};const{ret:f,entry:t}=this.get_entry_for_path(e);if(t==null)return{ret:f,parent_entry:null,filename:null,entry:null};if(!(t instanceof L))return{ret:O,parent_entry:null,filename:null,entry:null};const n=t.contents.get(s);return n===void 0?r?{ret:y,parent_entry:t,filename:s,entry:null}:{ret:M,parent_entry:null,filename:null,entry:null}:e.is_dir&&n.stat().filetype!=z?{ret:O,parent_entry:null,filename:null,entry:null}:{ret:y,parent_entry:t,filename:s,entry:n}}create_entry_for_path(e,r){const{ret:s,path:f}=S.from(e);if(f==null)return{ret:s,entry:null};let{ret:t,parent_entry:n,filename:i,entry:o}=this.get_parent_dir_and_entry_for_path(f,!0);if(n==null||i==null)return{ret:t,entry:null};if(o!=null)return{ret:te,entry:null};B.log("create",f);let a;return r?a=new L(new Map):a=new W(new ArrayBuffer(0)),n.contents.set(i,a),o=a,{ret:y,entry:o}}constructor(e){super(),this.parent=null,e instanceof Array?this.contents=new Map(e):this.contents=e;for(const r of this.contents.values())r instanceof L&&(r.parent=this)}}class H extends me{fd_filestat_get(){return{ret:0,filestat:new pe(this.ino,Ue,BigInt(0))}}fd_fdstat_get(){const e=new he(Ue,0);return e.fs_rights_base=BigInt(ce),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const r=new TextDecoder("utf-8",{fatal:!1});let s="";return new H(f=>{s+=r.decode(f,{stream:!0});const t=s.split(`
`);for(const[n,i]of t.entries())n<t.length-1?e(i):s=i})}constructor(e){super(),this.ino=F.issue_ino(),this.write=e}}var fe={},ue,ze;function et(){if(ze)return ue;ze=1;const x=function(e,r,s){var f=r||0,t=s||e.byteLength;this.bytes=new Uint8Array(e,f,t),this.ptr=0};return x.prototype.peekNumber=function(e){if(e<=0||typeof e!="number")return-1;for(var r=0,s=this.ptr+e-1;s>=this.ptr;)r<<=8,r|=this.bytes[s],--s;return r},x.prototype.readNumber=function(e){var r=this.peekNumber(e);return this.ptr+=e,r},x.prototype.peekSignedNumber=function(e){var r=this.peekNumber(e),s=Math.pow(2,e*8-1),f=s*2;return r>=s&&(r-=f),r},x.prototype.readSignedNumber=function(e){var r=this.peekSignedNumber(e);return this.ptr+=e,r},x.prototype.peekBytes=function(e,r){if(e<=0||typeof e!="number")return null;var s=this.bytes.subarray(this.ptr,this.ptr+e);return r&&(this.ptr+=e),s},x.prototype.readBytes=function(e){return this.peekBytes(e,!0)},x.prototype.peekString=function(e){if(e<=0||typeof e!="number")return"";for(var r="",s=this.ptr,f=this.ptr+e;s<f;++s)r+=String.fromCharCode(this.bytes[s]);return r},x.prototype.readString=function(e){var r=this.peekString(e);return this.ptr+=e,r},ue=x,ue}var De;function tt(){if(De)return fe;De=1;const x=et(),e=function(s,f){const t=s.readString(f),n=t.indexOf("\0");return n!=-1?t.substring(0,n):t};function r(s){this.isValid=!1,this.name=e(s,100),this.mode=e(s,8),this.uid=e(s,8),this.gid=e(s,8),this.size=parseInt(e(s,12),8),this.mtime=e(s,12),this.chksum=e(s,8),this.typeflag=e(s,1),this.linkname=e(s,100),this.maybeMagic=e(s,6),this.maybeMagic=="ustar"?(this.version=e(s,2),this.uname=e(s,32),this.gname=e(s,32),this.devmajor=e(s,8),this.devminor=e(s,8),this.prefix=e(s,155),this.prefix.length&&(this.name=this.prefix+"/"+this.name),s.readBytes(12)):s.readBytes(249),this.filename=this.name,this.fileData=null,+this.typeflag==0&&(this.fileData=new Uint8Array(s.bytes.buffer,s.ptr,this.size),this.name.length>0&&this.fileData&&this.fileData.buffer&&(this.isValid=!0)),s.ptr+=this.size;const f=512-s.ptr%512;f>0&&f<512&&s.readBytes(f)}return fe.untar=function(s){const f=new x(s),t=[];for(;f.peekNumber(4)!=0;){const n=new r(f);n&&n.isValid&&t.push(n)}return t},fe}var rt=tt();const nt={class:"flex flex-col md:flex-row h-full"},st={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},it={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},ot={class:"flex items-center gap-4"},at={class:"flex items-center gap-2"},lt={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},ft={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},ut={class:"relative group"},dt=["disabled"],ct={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_t={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},ht={class:"flex-1 min-h-0"},pt={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},gt={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},yt={class:"flex items-center gap-3"},mt={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},wt={key:0,class:"text-xs text-slate-500"},bt={key:0,class:"flex-1 flex items-center justify-center"},xt={class:"text-center space-y-4"},vt={class:"text-slate-400"},Ut={key:1,class:"flex-1 overflow-y-auto p-4 font-mono text-sm space-y-1"},kt={key:0,class:"text-red-400"},Bt={key:1,class:"text-emerald-400"},Et={class:"whitespace-pre-wrap"},At={key:0,class:"text-slate-500 italic"},Rt={__name:"ZigRunner",setup(x){const{t:e}=Re(),r={hello:`const std = @import("std");

pub fn main() !void {
    try std.fs.File.stdout().writeAll("Hello, World!\\n");
}`,loops:`const std = @import("std");

pub fn main() !void {
    var sum: u32 = 0;
    var i: u32 = 0;
    while (i <= 10) : (i += 1) {
        sum += i;
    }
    std.debug.print("Sum 0..10 is {d}\\n", .{sum});
}`,fizzbuzz:`const std = @import("std");

pub fn main() !void {
    const stdout = std.fs.File.stdout();
    var i: u8 = 1;
    while (i <= 20) : (i += 1) {
        if (i % 15 == 0) {
            try stdout.writeAll("FizzBuzz\\n");
        } else if (i % 3 == 0) {
            try stdout.writeAll("Fizz\\n");
        } else if (i % 5 == 0) {
            try stdout.writeAll("Buzz\\n");
        } else {
            // Convert i to string and write it
            var buffer: [3]u8 = undefined; // enough for numbers 1-20
            const num_str = try std.fmt.bufPrint(&buffer, "{d}", .{i});
            try stdout.writeAll(num_str);
            try stdout.writeAll("\\n");
        }
    }
}`},s=I(r.hello),f=I([]),t=I(!1),n=I(!1),i=I(!1),o=I(""),a=I(null),l=I("hello");let u=null,d=null;function c(U){return new L(new Map([...U.entries()].map(([g,k])=>k instanceof Map?[g,c(k)]:[g,new W(k)])))}const p=async()=>{if(!i.value){t.value=!0,f.value=[];try{const U="/tools/",g=`${U.endsWith("/")?U:U+"/"}zig-wasm/`;o.value="Loading Zig Compiler...";const k=await fetch(`${g}zig.wasm`);if(!k.ok)throw new Error(`Failed to fetch zig.wasm: ${k.statusText}`);u=await k.arrayBuffer(),o.value="Loading Standard Library...";const V=await fetch(`${g}zig.tar.gz`);if(!V.ok)throw new Error(`Failed to fetch zig.tar.gz: ${V.statusText}`);let P=await V.arrayBuffer();o.value="Extracting Standard Library...";const Y=new Uint8Array(P).slice(0,2);if(Y[0]===31&&Y[1]===139){const R=new DecompressionStream("gzip"),T=new Response(P).body.pipeThrough(R);P=await new Response(T).arrayBuffer()}const ne=rt.untar(P),Z=new Map;for(const R of ne){let T=R.filename;if(T.startsWith("zig-out/lib/")&&(T=T.slice(8)),!T.startsWith("lib/"))continue;const $=T.slice(4);if(!$)continue;const q=$.split("/");let j=Z;for(const D of q.slice(0,-1))j.has(D)||j.set(D,new Map),j=j.get(D);j.set(q[q.length-1],R.fileData)}d=c(Z),i.value=!0,o.value=""}catch(U){console.error("Zig load failed",U),f.value.push({type:"error",message:"Failed to load Zig runtime: "+U.message})}finally{t.value=!1}}},_=async()=>{if(i.value||await p(),!(!u||!d)){n.value=!0,f.value=[],a.value=null;try{const U=performance.now(),g=new Map;g.set("main.zig",new W(new TextEncoder().encode(s.value)));const k=[new _e(new W([])),H.lineBuffered(D=>f.value.push({type:"log",message:D})),H.lineBuffered(D=>f.value.push({type:"error",message:D})),new ee(".",g),new ee("/lib",d.contents),new ee("/cache",new Map)],V=["zig.wasm","build-exe","main.zig","-fno-llvm","-fno-lld","-fno-ubsan-rt","-fno-entry"],P=[],Y=new Ae(V,P,k),{instance:ne}=await WebAssembly.instantiate(u,{wasi_snapshot_preview1:Y.wasiImport}),Z=Y.start(ne);if(Z!==0)throw new Error(`Compilation failed (Exit Code: ${Z})`);const R=g.get("main.wasm");if(!R||!(R instanceof W))throw console.log("Files in CWD:",Array.from(g.keys())),new Error("Compilation successful but 'main.wasm' not found.");f.value.push({type:"log",message:"Compilation successful. Running..."});const T=[new _e(new W([])),H.lineBuffered(D=>f.value.push({type:"log",message:D})),H.lineBuffered(D=>f.value.push({type:"error",message:D})),new ee(".",new Map)],$=new Ae(["main.wasm"],[],T),{instance:q}=await WebAssembly.instantiate(R.data,{wasi_snapshot_preview1:$.wasiImport});$.start(q);const j=performance.now();a.value=(j-U).toFixed(2)}catch(U){f.value.push({type:"error",message:U.message}),console.error(U)}finally{n.value=!1}}},m=()=>{r[l.value]&&(s.value=r[l.value])},v=()=>{f.value=[],a.value=null},N=U=>U==="error"?"text-red-400":"text-emerald-400";return Ie(()=>{p()}),(U,g)=>(A(),E("div",nt,[w("div",st,[w("div",it,[w("div",ot,[w("div",at,[g[2]||(g[2]=w("svg",{class:"w-5 h-5 text-orange-400",viewBox:"0 0 128 128",fill:"currentColor"},[w("path",{d:"M12.94 13.916 2.08 26.657h111.45L128 13.916H12.94zm-1.89 12.74L0 39.398l112.52.09L124.96 26.657H11.05zm-.1 38.648-9.98 12.74 125.86.095L115.82 65.304H10.95zm-1.63 12.74L0 90.785l114.73.09 11.23-12.83H9.32zm9.15 12.74L7.54 116.265h111.45l1.43-12.74H18.47z"})],-1)),g[3]||(g[3]=w("span",{class:"font-bold text-white"},"Zig",-1)),i.value?(A(),E("span",lt,C(K(e)("tools.code-playground.common.ready")),1)):t.value?se("",!0):(A(),E("span",ft,C(K(e)("tools.code-playground.common.not_loaded")),1))]),w("div",ut,[Ce(w("select",{"onUpdate:modelValue":g[0]||(g[0]=k=>l.value=k),onChange:m,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all cursor-pointer"},[...g[4]||(g[4]=[w("option",{value:"hello"},"Hello World",-1),w("option",{value:"loops"},"Loops & Vars",-1),w("option",{value:"fizzbuzz"},"FizzBuzz",-1)])],544),[[Se,l.value]]),g[5]||(g[5]=w("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[w("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[w("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),w("button",{onClick:_,disabled:t.value||n.value,class:we(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",t.value||n.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-emerald-600 hover:bg-emerald-500 text-white"])},[t.value||n.value?(A(),E("svg",ct,[...g[6]||(g[6]=[w("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(A(),E("svg",_t,[...g[7]||(g[7]=[w("path",{d:"M8 5v14l11-7z"},null,-1)])])),Oe(" "+C(t.value?"Loading...":n.value?"Running...":K(e)("tools.code-playground.common.run")),1)],10,dt)]),w("div",ht,[Fe(Me,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=k=>s.value=k),language:"zig",theme:"vs-dark",height:"100%",minimap:!1},null,8,["modelValue"])])]),w("div",pt,[w("div",gt,[w("div",yt,[w("span",mt,C(K(e)("tools.code-playground.common.output")),1),a.value?(A(),E("span",wt,C(a.value)+"ms",1)):se("",!0)]),w("button",{onClick:v,class:"text-xs text-slate-500 hover:text-white transition-colors"},C(K(e)("tools.code-playground.common.clear")),1)]),t.value?(A(),E("div",bt,[w("div",xt,[g[8]||(g[8]=w("div",{class:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),w("div",vt,C(o.value),1)])])):(A(),E("div",Ut,[(A(!0),E(Ve,null,je(f.value,(k,V)=>(A(),E("div",{key:V,class:we(["flex items-start gap-2",N(k.type)])},[k.type==="error"?(A(),E("span",kt,"✗")):(A(),E("span",Bt,"›")),w("span",Et,C(k.message),1)],2))),128)),f.value.length===0&&!t.value&&!n.value?(A(),E("div",At,' Click "Run" to execute Zig code... ')):se("",!0)]))])]))}};export{Rt as default};
