import{_ as R,u as L,r as d,o as $,a as j,c as r,j as i,d as o,h as N,s as U,F as E,f as M,t as c,e as w,n as S,i as D,b as H,g as I}from"./index-3W9u9xF1.js";import W from"./MonacoEditor-DFCuHsc7.js";import{x as P,a as q}from"./xterm-Btcyv0ds.js";import{f as G,a as B}from"./ExampleLoader-C0CuCz3g.js";import"./monaco-editor-DrHUTMTD.js";const J={class:"flex flex-col md:flex-row h-full"},K={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},Q={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},X={class:"flex items-center gap-4"},Y={class:"relative group"},Z=["label"],ee=["value"],te={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},oe={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},ae=["disabled"],le={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},se={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},ne={class:"flex-1 min-h-0"},re={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900 border-t md:border-t-0 md:border-l border-slate-700"},ie={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},de={class:"flex items-center gap-3"},ce={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},ue={key:0,class:"text-xs text-slate-500"},me={class:"flex-1 min-h-0 p-2 bg-[#0f172a]"},pe={__name:"OctaveRunner",setup(ve){const{t:m}=L(),p=d(""),v=d(""),_=d(null),n=d(!1),f=d(!1),x=d(null),u=d(""),O=async()=>{try{const e=await G("octave");if(_.value=e,e.chapters&&e.chapters.length>0&&e.chapters[0].examples.length>0){const t=e.chapters[0].examples[0];v.value=t.path,p.value=await B("octave",t.path)}}catch(e){console.error("Failed to load Octave manifest:",e)}};let a=null,h=null;const y=d(null),V=()=>{a=new P.Terminal({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:{background:"#0f172a",foreground:"#e2e8f0"}}),h=new q.FitAddon,a.loadAddon(h),a.open(y.value),h.fit(),a.write(`\x1B[38;5;244mResult will appear here...\x1B[0m\r
`)};let g=null;const z=e=>new Promise((t,l)=>{if(window.OCTAVE){t();return}const s=document.createElement("script");s.src=e,s.onload=t,s.onerror=l,document.head.appendChild(s)}),F=async()=>{n.value=!0,u.value=m("tools.code-playground.common.loading")||"Loading Octave...";try{const e="/tools/",t=`${e.endsWith("/")?e:e+"/"}octave-wasm/octave.js`;if(await z(t),!window.OCTAVE)throw new Error("Octave script loaded but OCTAVE global not found.");window.Module={locateFile:l=>`${e.endsWith("/")?e:e+"/"}octave-wasm/${l}`,print:l=>{a&&a.write(l+`\r
`)},printErr:l=>{a&&a.write(`\x1B[31m${l}\x1B[0m\r
`)},postRun:()=>{if(window.Module.execute_interp)try{window.Module.execute_interp(),console.log("Octave interpreter initialized")}catch(l){console.error("Failed to initialize interpreter:",l)}f.value=!0,n.value=!1,u.value="",console.log("Octave Ready")}},g=await window.OCTAVE(window.Module)}catch(e){u.value=`Failed to load Octave: ${e.message}`,n.value=!1,console.error(e)}},T=async()=>{if(!f.value||!g)return;n.value=!0,x.value=null,a.clear();const e=performance.now();try{g.eval_string(p.value.replace(/\r/g,""));const t=performance.now();x.value=(t-e).toFixed(2)}catch(t){a.write(`\x1B[31mError: ${t.message}\x1B[0m\r
`)}finally{n.value=!1}},A=async()=>{if(v.value){k();try{n.value=!0,u.value="Loading example...",p.value=await B("octave",v.value)}catch(e){a&&a.write(`\x1B[31mFailed to load example: ${e.message}\x1B[0m\r
`)}finally{n.value=!1,u.value=""}}},k=()=>{a.clear(),x.value=null};$(async()=>{V(),await F(),O(),window.addEventListener("resize",C)}),j(()=>{a&&a.dispose(),window.removeEventListener("resize",C)});const C=()=>{h&&h.fit()};return(e,t)=>{var l;return i(),r("div",J,[o("div",K,[o("div",Q,[o("div",X,[t[3]||(t[3]=o("div",{class:"flex items-center gap-2"},[o("svg",{class:"w-5 h-5 text-orange-500",viewBox:"0 0 128 128",fill:"currentColor"},[o("path",{d:"M123.965 91.902c-7.246-18.297-13.262-37.058-20.184-55.476-3.054-7.84-6.047-15.746-10.215-23.082-1.656-2.633-3.238-5.528-5.953-7.215a4.013 4.013 0 00-2.222-.606c-1.27.028-2.536.594-3.504 1.415-3.645 2.886-5.805 7.082-8.227 10.949-4.277 7.172-8.789 14.687-15.941 19.347-3.36 2.371-7.762 2.63-11 5.172-4.43 3.34-7.442 8.078-11.074 12.184-.829.988-2.11 1.383-3.227 1.918C21.578 60.93 10.738 65.336 0 69.98c9.09 7.032 18.777 13.29 28.05 20.079 2.544-.504 5.098-1.547 7.72-1.082 4.16 1.3 6.597 5.285 8.503 8.93 3.875 7.94 6.676 16.323 9.813 24.57 5.246-.375 9.969-3.079 14.027-6.258 7.809-6.324 13.758-14.5 20.305-22.047 3.14-3.3 6.34-7.23 11.05-8.149 4.762-1.152 9.864.555 13.395 3.836 4.957 4.43 9.344 9.551 15.137 12.942-.777-3.836-2.645-7.278-4.035-10.899zM42.96 79.012c-4.57 2.703-9.426 4.93-14.176 7.289-7.457-4.996-14.723-10.29-22.05-15.465 9.878-4.328 19.91-8.348 29.917-12.387 4.746 3.703 9.637 7.223 14.383 10.926-2.23 3.563-4.914 6.871-8.074 9.637zm10.168-12.414C48.414 63.058 43.64 59.609 39 55.977c2.977-4.055 6.238-7.977 10.14-11.172 2.587-1.657 5.743-2.117 8.426-3.61 6.368-3.18 10.711-9.011 14.86-14.582-5.317 13.805-10.992 27.664-19.297 39.985zm0 0"})]),o("span",{class:"font-bold text-white"},"Octave")],-1)),o("div",Y,[N(o("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),onChange:A,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all cursor-pointer"},[(i(!0),r(E,null,M(((l=_.value)==null?void 0:l.chapters)||[],s=>(i(),r("optgroup",{key:s.title,label:s.title},[(i(!0),r(E,null,M(s.examples||[],b=>(i(),r("option",{key:b.path,value:b.path},c(b.name),9,ee))),128))],8,Z))),128))],544),[[U,v.value]]),t[2]||(t[2]=o("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),f.value?(i(),r("span",te,c(w(m)("tools.code-playground.common.ready")),1)):(i(),r("span",oe,c(u.value||"Loading..."),1))]),o("button",{onClick:T,disabled:n.value||!f.value,class:S(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",n.value||!f.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white"])},[n.value?(i(),r("svg",le,[...t[4]||(t[4]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(i(),r("svg",se,[...t[5]||(t[5]=[o("path",{d:"M8 5v14l11-7z"},null,-1)])])),D(" "+c(n.value?"Running...":w(m)("tools.code-playground.common.run")),1)],10,ae)]),o("div",ne,[H(W,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),language:"matlab",height:"100%",minimap:!1},null,8,["modelValue"])])]),o("div",re,[o("div",ie,[o("div",de,[o("span",ce,c(w(m)("tools.code-playground.common.output")),1),x.value?(i(),r("span",ue,c(x.value)+"ms",1)):I("",!0)]),o("button",{onClick:k,class:"text-xs text-slate-500 hover:text-white transition-colors"},c(w(m)("tools.code-playground.common.clear")),1)]),o("div",me,[o("div",{ref_key:"terminalContainer",ref:y,class:"w-full h-full"},null,512)])])])}}},be=R(pe,[["__scopeId","data-v-273a1e29"]]);export{be as default};
