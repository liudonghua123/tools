const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-2txK4veA.js","assets/markdown-B4_BPOko.js","assets/monaco-editor-DrHUTMTD.js","assets/monaco-editor-C4Ekkcmw.css","assets/__vite-browser-external-D7Ct-6yo.js"])))=>i.map(i=>d[i]);
import{_ as J}from"./monaco-editor-DrHUTMTD.js";import{_ as X,u as Z,r as p,o as ee,a as te,c as n,j as r,d as t,g as I,t as m,e as b,h as z,q as oe,F as Q,f as W,n as L,i as se,b as le,v as ae,D as ne}from"./index-DkX3DOGW.js";import re from"./MonacoEditor-DRPUyzCI.js";import{f as ue,a as O}from"./ExampleLoader-C0CuCz3g.js";const ie={class:"flex flex-col md:flex-row h-full"},de={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},ce={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},pe={class:"flex items-center gap-4"},me={class:"flex items-center gap-2"},ge={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},ve={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},he={class:"relative group"},fe=["label"],ye=["value"],xe=["disabled"],be={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},we={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},_e={class:"flex-1 min-h-0"},ke={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},Se={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},$e={class:"flex items-center gap-3"},De={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},Pe={key:0,class:"text-xs text-slate-500"},Te={class:"flex-1 overflow-y-auto p-4 space-y-4"},je={class:"font-medium text-xs text-slate-400 mb-1"},Ce={class:"text-sm text-slate-200 whitespace-pre-wrap"},Ee={key:0,class:"flex items-center gap-2 p-3 rounded-lg mr-auto bg-slate-700/50"},Ie={class:"border-t border-slate-700 p-4"},Qe={class:"flex gap-2"},We=["placeholder","disabled"],qe=["disabled"],Fe={key:0},Me={key:1},Re={class:"mt-2 text-xs text-slate-500"},Ve={__name:"SwiPrologRunner",emits:["output","error","ready"],setup(Be,{emit:U}){const{t:f}=Z(),q=U,$=p(""),F=p(null),T=p(""),u=p([]),v=p(!1),w=p(!1),j=p(""),D=p(null),l=p([]),P=p(""),_=p(!1);let k=null;const A=async()=>{try{const o=await ue("swipl");if(F.value=o,o.chapters&&o.chapters.length>0&&o.chapters[0].examples.length>0){const e=o.chapters[0].examples[0];T.value=e.path,$.value=await O("swipl",e.path)}}catch(o){console.error("Failed to load SWI-Prolog manifest:",o)}},M=async()=>{if(!w.value){v.value=!0,j.value="Loading SWI-Prolog runtime...";try{const{default:o}=await J(async()=>{const{default:s}=await import("./index-2txK4veA.js").then(i=>i.i);return{default:s}},__vite__mapDeps([0,1,2,3,4]));j.value="Initializing SWI-Prolog interpreter...";const e="/tools/",g=`${e.endsWith("/")?e:e+"/"}swipl-wasm/`;k=await o({locateFile:s=>`${g}${s}`}),w.value=!0,q("ready")}catch(o){u.value.push({type:"error",message:`Failed to load SWI-Prolog runtime: ${o.message}`}),console.error(o)}finally{v.value=!1,j.value=""}}},H=async()=>{if(w.value||await M(),!k){u.value.push({type:"error",message:"SWI-Prolog interpreter not ready"}),l.value.push({sender:"prolog",content:"SWI-Prolog interpreter not ready",timestamp:Date.now()});return}u.value=[],l.value=[],D.value=null;try{const o=performance.now(),e="scratch.pl";if(k.FS.writeFile(e,$.value),k.prolog.query(`['${e}'].`).once()){u.value.push({type:"log",message:"Prolog code loaded successfully"}),l.value.push({sender:"prolog",content:"Prolog code loaded successfully",timestamp:Date.now()});const i=$.value.split(`
`);for(const y of i){const c=y.trim();if(c.startsWith("?-")){const h=c.substring(2).trim();if(h&&h.endsWith(".")){const x=h.slice(0,-1);try{u.value.push({type:"log",message:`Query: ${x}`}),l.value.push({sender:"prolog",content:`Query: ${x}`,timestamp:Date.now()});const S=k.prolog.query(x);if(S)try{const d=[];for(const a of S)if(a&&a.$tag==="bindings"){const C={...a};delete C.$tag,Object.keys(C).length===0?d.push(!0):d.push({...C})}if(d.length===0){const a="No solutions found";u.value.push({type:"log",message:a}),l.value.push({sender:"prolog",content:a,timestamp:Date.now()})}else d.forEach((a,C)=>{let E;if(typeof a=="object"&&a!==null){const N=Object.entries(a);N.length>0?E=N.map(([Y,G])=>`${Y}=${G}`).join(", "):E="true"}else E=String(a);const B=`Solution ${C+1}: ${E}`;u.value.push({type:"log",message:B}),l.value.push({sender:"prolog",content:B,timestamp:Date.now()})})}catch(d){const a=`Query execution error: ${d.message}`;u.value.push({type:"log",message:a}),l.value.push({sender:"prolog",content:a,timestamp:Date.now()})}else{const d="Query failed or has no solutions";u.value.push({type:"log",message:d}),l.value.push({sender:"prolog",content:d,timestamp:Date.now()})}}catch(S){const d=`Query error: ${S.message}`;u.value.push({type:"error",message:d}),l.value.push({sender:"prolog",content:d,timestamp:Date.now()})}}}}}else{const i="Failed to load Prolog code";u.value.push({type:"error",message:i}),l.value.push({sender:"prolog",content:i,timestamp:Date.now()})}const s=performance.now();D.value=(s-o).toFixed(2)}catch(o){const e=o.message;u.value.push({type:"error",message:e}),l.value.push({sender:"prolog",content:e,timestamp:Date.now()}),q("error",o)}},K=async()=>{if(T.value){V();try{v.value=!0,j.value="Loading example...",$.value=await O("swipl",T.value)}catch(o){u.value.push({type:"error",message:`Failed to load example: ${o.message}`})}finally{v.value=!1,j.value=""}}},R=async()=>{if(!w.value||_.value||!P.value.trim())return;const o=P.value.trim();l.value.push({sender:"user",content:o,timestamp:Date.now()}),P.value="",_.value=!0;try{if(!k)throw new Error("SWI-Prolog interpreter not ready");const e=performance.now();let g=o;g.endsWith(".")&&(g=g.slice(0,-1));const s=k.prolog.query(g);if(s)try{const y=[];for(const c of s)if(c&&c.$tag==="bindings"){const h={...c};delete h.$tag,Object.keys(h).length===0?y.push(!0):y.push({...h})}y.length===0?l.value.push({sender:"prolog",content:"No solutions found",timestamp:Date.now()}):y.forEach((c,h)=>{let x;if(typeof c=="object"&&c!==null){const S=Object.entries(c);S.length>0?x=S.map(([d,a])=>`${d}=${a}`).join(", "):x="true"}else x=String(c);l.value.push({sender:"prolog",content:`Solution ${h+1}: ${x}`,timestamp:Date.now()})})}catch(y){l.value.push({sender:"prolog",content:`Query execution error: ${y.message}`,timestamp:Date.now()})}else l.value.push({sender:"prolog",content:"Query failed or has no solutions",timestamp:Date.now()});const i=performance.now();D.value=(i-e).toFixed(2)}catch(e){l.value.push({sender:"prolog",content:`Error: ${e.message}`,timestamp:Date.now()}),console.error(e)}finally{_.value=!1}},V=()=>{u.value=[],l.value=[],D.value=null};return ee(()=>{M(),A()}),te(()=>{}),(o,e)=>{var g;return r(),n("div",ie,[t("div",de,[t("div",ce,[t("div",pe,[t("div",me,[e[3]||(e[3]=t("svg",{class:"w-5 h-5 text-amber-400",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13.5v6.5l5.25 3.28.75-1.22-4.5-2.78v-5.5z"})],-1)),e[4]||(e[4]=t("span",{class:"font-bold text-white"},"SWI-Prolog",-1)),w.value?(r(),n("span",ge,m(b(f)("tools.code-playground.common.ready")),1)):v.value?I("",!0):(r(),n("span",ve,m(b(f)("tools.code-playground.common.not_loaded")),1))]),t("div",he,[z(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>T.value=s),onChange:K,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-amber-500 transition-all cursor-pointer"},[(r(!0),n(Q,null,W((g=F.value)==null?void 0:g.chapters,s=>(r(),n("optgroup",{key:s.title,label:s.title},[(r(!0),n(Q,null,W(s.examples,i=>(r(),n("option",{key:i.path,value:i.path},m(i.name),9,ye))),128))],8,fe))),128))],544),[[oe,T.value]]),e[5]||(e[5]=t("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),t("button",{onClick:H,disabled:v.value,class:L(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",v.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-emerald-600 hover:bg-emerald-500 text-white"])},[v.value?(r(),n("svg",be,[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(r(),n("svg",we,[...e[7]||(e[7]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])),se(" "+m(v.value?"Loading...":b(f)("tools.code-playground.common.run")),1)],10,xe)]),t("div",_e,[le(re,{modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=s=>$.value=s),language:"prolog",theme:"vs-dark",height:"100%",minimap:!1},null,8,["modelValue"])])]),t("div",ke,[t("div",Se,[t("div",$e,[t("span",De,m(b(f)("tools.code-playground.common.chat")),1),D.value?(r(),n("span",Pe,m(D.value)+"ms",1)):I("",!0)]),t("button",{onClick:V,class:"text-xs text-slate-500 hover:text-white transition-colors"},m(b(f)("tools.code-playground.common.clear")),1)]),t("div",Te,[(r(!0),n(Q,null,W(l.value,(s,i)=>(r(),n("div",{key:i,class:L(["p-3 rounded-lg max-w-[80%]",s.sender==="user"?"ml-auto bg-slate-800":"mr-auto bg-slate-700/50"])},[t("div",je,m(s.sender==="user"?"You":"Prolog"),1),t("div",Ce,m(s.content),1)],2))),128)),_.value?(r(),n("div",Ee,[...e[8]||(e[8]=[t("div",{class:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"},null,-1),t("div",{class:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-100"},null,-1),t("div",{class:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-200"},null,-1)])])):I("",!0)]),t("div",Ie,[t("div",Qe,[z(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>P.value=s),onKeyup:ne(R,["enter"]),placeholder:b(f)("tools.code-playground.swipl.query_placeholder"),class:"flex-1 bg-slate-800 border border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-200 focus:outline-none focus:ring-1 focus:ring-amber-500",disabled:!w.value||_.value},null,40,We),[[ae,P.value]]),t("button",{onClick:R,disabled:!w.value||_.value||!P.value.trim(),class:"px-4 py-2 bg-amber-600 hover:bg-amber-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-lg text-sm font-medium transition-colors"},[_.value?(r(),n("span",Fe,"...")):(r(),n("span",Me,m(b(f)("tools.code-playground.common.send")),1))],8,qe)]),t("div",Re,m(b(f)("tools.code-playground.swipl.query_help")),1)])])])}}},Ue=X(Ve,[["__scopeId","data-v-0b1db894"]]);export{Ue as default};
