import{_ as z,u as I,r as u,o as J,c as t,j as s,d as e,i as q,t as r,e as p,F as v,f as x,h as U,q as A,b as O,g as N}from"./index-DkX3DOGW.js";import P from"./MonacoEditor-DRPUyzCI.js";import{f as H,a as V}from"./ExampleLoader-C0CuCz3g.js";import"./monaco-editor-DrHUTMTD.js";const W={class:"flex flex-col md:flex-row h-full"},G={class:"w-full md:w-64 h-48 md:h-full bg-slate-900 border-b md:border-b-0 md:border-r border-slate-700 flex flex-col"},K={class:"px-4 py-3 border-b border-slate-700 font-bold text-slate-300 flex items-center gap-2"},X={class:"flex-1 overflow-y-auto p-2"},Y={key:0,class:"text-xs text-slate-500 text-center py-4"},Z={key:1,class:"text-xs text-slate-500 text-center py-4"},ee={key:2,class:"space-y-1"},te={class:"flex items-center gap-2 text-slate-300 font-medium px-2 py-1 hover:bg-slate-800 rounded"},se={class:"pl-6 space-y-0.5"},le={class:"text-slate-600"},oe={class:"flex-1 flex flex-col min-w-0 h-full md:h-auto"},ae={class:"h-1/2 flex flex-col border-b border-slate-700"},ne={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},re={class:"flex items-center gap-4"},ie={class:"font-bold text-white"},ce={class:"relative group"},de=["label"],ue=["value"],me={class:"flex-1 min-h-0"},pe={class:"h-1/2 flex flex-col bg-slate-900 overflow-hidden"},ve={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},xe={class:"flex items-center gap-3"},fe={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},he={key:0,class:"text-xs text-slate-500"},_e={class:"flex-1 overflow-auto p-4"},be={key:0,class:"text-slate-500 italic text-sm"},ge={key:0,class:"text-red-400 p-2 bg-red-900/10 rounded border border-red-900/20 text-sm font-mono"},ye={key:1,class:"text-emerald-400 p-2 text-sm"},we={key:2,class:"overflow-x-auto"},ke={class:"w-full text-left text-sm border-collapse"},qe={class:"mt-1 text-xs text-slate-500"},Se={__name:"SqliteRunner",emits:["ready"],setup(Ee,{emit:j}){const{t:m}=I(),B=j,h=u(""),_=u(""),S=u(null),c=u([]),k=u([]),y=u(!1),E=u(!1),b=u(""),g=u(null),R=async()=>{try{const l=await H("sqlite");if(S.value=l,l.chapters&&l.chapters.length>0&&l.chapters[0].examples.length>0){const o=l.chapters[0].examples[0];_.value=o.path,h.value=await V("sqlite",o.path)}}catch(l){console.error("Failed to load SQLite manifest:",l)}};let d=null,C=null;const T=async()=>{if(d)return d;y.value=!0,b.value="Loading SQLite runtime...";try{const l="/tools/",o=`${l.endsWith("/")?l:l+"/"}sql-wasm/`;if(window.initSqlJs||await new Promise((i,a)=>{const n=document.createElement("script");n.src=`${o}sql-wasm.js`,n.onload=i,n.onerror=()=>a(new Error("Failed to load sql-wasm.js")),document.head.appendChild(n)}),b.value="Initializing Database...",window.initSqlJs)C=await window.initSqlJs({locateFile:i=>`${o}${i}`}),d=new C.Database,await M();else throw new Error("initSqlJs not found");return E.value=!0,B("ready"),d}catch(l){c.value=[{error:`Failed to load SQLite: ${l.message}`}],console.error(l)}finally{y.value=!1,b.value=""}},M=async()=>{if(!d)return;const l=[],o=d.exec("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'");if(o.length>0)for(const i of o[0].values){const a=i[0],n=d.exec(`PRAGMA table_info(${a})`),f=[];n.length>0&&f.push(...n[0].values.map(w=>({name:w[1],type:w[2]}))),l.push({name:a,columns:f})}k.value=l},$=async()=>{c.value=[],g.value=null,d||await T();try{const l=performance.now(),o=d.exec(h.value),i=performance.now();g.value=(i-l).toFixed(2),await M(),o.length===0?c.value=[{message:"Query executed successfully. No results returned."}]:c.value=o}catch(l){c.value=[{error:l.message}]}},D=async()=>{if(_.value){L();try{y.value=!0,b.value="Loading example...",h.value=await V("sqlite",_.value)}catch(l){c.value=[{error:`Failed to load example: ${l.message}`}]}finally{y.value=!1,b.value=""}}},L=()=>{c.value=[],g.value=null};return J(()=>{R()}),(l,o)=>{var i;return s(),t("div",W,[e("div",G,[e("div",K,[o[2]||(o[2]=e("svg",{class:"w-4 h-4",viewBox:"0 0 128 128",fill:"currentColor"},[e("path",{d:"M115.95 2.781c-5.504-4.906-12.16-2.933-18.738 2.902a47.9 47.9 0 00-2.918 2.856c-11.246 11.93-21.684 34.02-24.926 50.895 1.262 2.563 2.25 5.832 2.902 8.328.325 1.238.617 2.488.875 3.746 0 0-.101-.379-.515-1.578l-.266-.777a8.12 8.12 0 00-.176-.426c-.734-1.707-2.761-5.309-3.656-6.875a172.299 172.299 0 00-2.008 6.27c2.582 4.714 4.149 12.8 4.149 12.8s-.133-.527-.782-2.355c-.57-1.617-3.437-6.637-4.117-7.809-1.16 4.29-1.62 7.18-1.207 7.883.813 1.363 1.578 3.723 2.25 6.324 1.528 5.868 2.586 13.016 2.586 13.016l.094 1.192c-.203 4.886-.102 9.781.297 14.656.508 6.113 1.457 11.359 2.668 14.172l.824-.45c-1.781-5.535-2.504-12.792-2.184-21.155.477-12.79 3.422-28.215 8.856-44.29 9.191-24.261 21.938-43.733 33.602-53.034-10.63 9.601-25.023 40.695-29.332 52.203C79.404 74.162 75.99 86.252 73.93 97.84c3.555-10.863 15.043-15.527 15.043-15.527s5.637-6.954 12.223-16.883c-3.945.898-10.426 2.441-12.598 3.351-3.2 1.34-4.063 1.797-4.063 1.797s10.371-6.312 19.27-9.172c12.234-19.27 25.566-46.645 12.145-58.625M16.896 5.681c-5.398.02-9.77 4.39-9.785 9.789v88.574c.016 5.398 4.39 9.765 9.785 9.785h50.227a122.816 122.816 0 01-.277-14.438c-.031-.332-.059-.754-.086-1.067a143.095 143.095 0 00-2.523-12.684c-.645-2.507-1.465-4.789-1.965-5.636-.621-1.051-.524-1.653-.52-2.305 0-.64.082-1.305.2-2.059.316-1.878.73-3.738 1.246-5.574l1.156-.148c-.09-.188-.074-.348-.164-.516l-.219-2.031c.64-2.137 1.316-4.262 2.04-6.371l1.066-.102c-.043-.082-.055-.203-.098-.28l-.23-1.685c3.363-17.496 13.8-39.699 25.601-52.219.352-.37.711-.683 1.055-1.035z"})],-1)),q(" "+r(p(m)("tools.code-playground.sqlite.database")),1)]),e("div",X,[E.value?k.value.length===0?(s(),t("div",Z,r(p(m)("tools.code-playground.sqlite.no_tables")),1)):(s(),t("div",ee,[(s(!0),t(v,null,x(k.value,a=>(s(),t("div",{key:a.name,class:"text-sm"},[e("div",te,[o[3]||(o[3]=e("svg",{class:"w-3 h-3 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),q(" "+r(a.name),1)]),e("div",se,[(s(!0),t(v,null,x(a.columns,n=>(s(),t("div",{key:n.name,class:"flex justify-between text-xs text-slate-500 px-2 py-0.5 hover:bg-slate-800/50 rounded"},[e("span",null,r(n.name),1),e("span",le,r(n.type),1)]))),128))])]))),128))])):(s(),t("div",Y,r(p(m)("tools.code-playground.sqlite.no_db")),1))])]),e("div",oe,[e("div",ae,[e("div",ne,[e("div",re,[e("span",ie,r(p(m)("tools.code-playground.sqlite.query")),1),e("div",ce,[U(e("select",{"onUpdate:modelValue":o[0]||(o[0]=a=>_.value=a),onChange:D,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-emerald-500 transition-all cursor-pointer"},[(s(!0),t(v,null,x(((i=S.value)==null?void 0:i.chapters)||[],a=>(s(),t("optgroup",{key:a.title,label:a.title},[(s(!0),t(v,null,x(a.examples||[],n=>(s(),t("option",{key:n.path,value:n.path},r(n.name),9,ue))),128))],8,de))),128))],544),[[A,_.value]]),o[4]||(o[4]=e("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),e("button",{onClick:$,class:"px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2 bg-emerald-600 hover:bg-emerald-500 text-white"},[o[5]||(o[5]=e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M8 5v14l11-7z"})],-1)),q(" "+r(p(m)("tools.code-playground.common.run")),1)])]),e("div",me,[O(P,{modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=a=>h.value=a),language:"sql",theme:"vs-dark",height:"100%"},null,8,["modelValue"])])]),e("div",pe,[e("div",ve,[e("div",xe,[e("span",fe,r(p(m)("tools.code-playground.sqlite.results")),1),g.value?(s(),t("span",he,r(g.value)+"ms",1)):N("",!0)]),e("button",{onClick:L,class:"text-xs text-slate-500 hover:text-white transition-colors"},r(p(m)("tools.code-playground.common.clear")),1)]),e("div",_e,[c.value.length===0?(s(),t("div",be," Run query to see results... ")):N("",!0),(s(!0),t(v,null,x(c.value,(a,n)=>(s(),t("div",{key:n,class:"mb-6 last:mb-0"},[a.error?(s(),t("div",ge," Error: "+r(a.error),1)):a.message?(s(),t("div",ye,r(a.message),1)):(s(),t("div",we,[e("table",ke,[e("thead",null,[e("tr",null,[(s(!0),t(v,null,x(a.columns,f=>(s(),t("th",{key:f,class:"bg-slate-800 p-2 border border-slate-700 text-slate-300 font-medium whitespace-nowrap"},r(f),1))),128))])]),e("tbody",null,[(s(!0),t(v,null,x(a.values,(f,w)=>(s(),t("tr",{key:w,class:"hover:bg-slate-800/30"},[(s(!0),t(v,null,x(f,(F,Q)=>(s(),t("td",{key:Q,class:"p-2 border border-slate-700 text-slate-400 whitespace-nowrap font-mono"},r(F===null?"NULL":F),1))),128))]))),128))])]),e("div",qe,r(p(m)("tools.code-playground.sqlite.row_count",[a.values.length])),1)]))]))),128))])])])])}}},Ne=z(Se,[["__scopeId","data-v-b906e91b"]]);export{Ne as default};
