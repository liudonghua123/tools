import{u as Ie,r as N,o as Ce,c as k,j as E,d as x,g as ae,t as I,e as X,h as Oe,s as Ve,F as oe,f as le,n as xe,i as Se,b as je}from"./index-hw7nIlup.js";import Me from"./MonacoEditor-D1-m5bfC.js";import{f as Fe,a as ve}from"./ExampleLoader-C0CuCz3g.js";import{u as Pe}from"./untar-D4OOux-1.js";import"./monaco-editor-DrHUTMTD.js";const fe=0,ue=1,m=0,h=8,ne=20,G=28,Ue=31,We=37,P=44,He=52,j=54,ke=55,w=58,_e=63,Ee=76,he=64;class J{static read_bytes(e,r){const o=new J;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const u=[];for(let t=0;t<o;t++)u.push(J.read_bytes(e,r+8*t));return u}}class Q{static read_bytes(e,r){const o=new Q;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const u=[];for(let t=0;t<o;t++)u.push(Q.read_bytes(e,r+8*t));return u}}const Ge=0,Ye=1,Le=2,Be=2,R=3,re=4;class de{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,r){e.setBigUint64(r,this.d_next,!0),e.setBigUint64(r+8,this.d_ino,!0),e.setUint32(r+16,this.dir_name.length,!0),e.setUint8(r+20,this.d_type)}write_name_bytes(e,r,o){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,o)),r)}constructor(e,r,o,u){const t=new TextEncoder().encode(o);this.d_next=e,this.d_ino=r,this.d_namlen=t.byteLength,this.d_type=u,this.dir_name=t}}const Ze=1;class ge{write_bytes(e,r){e.setUint8(r,this.fs_filetype),e.setUint16(r+2,this.fs_flags,!0),e.setBigUint64(r+8,this.fs_rights_base,!0),e.setBigUint64(r+16,this.fs_rights_inherited,!0)}constructor(e,r){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=r}}const ce=1,q=2,Ae=4,De=8;class me{write_bytes(e,r){e.setBigUint64(r,this.dev,!0),e.setBigUint64(r+8,this.ino,!0),e.setUint8(r+16,this.filetype),e.setBigUint64(r+24,this.nlink,!0),e.setBigUint64(r+32,this.size,!0),e.setBigUint64(r+38,this.atim,!0),e.setBigUint64(r+46,this.mtim,!0),e.setBigUint64(r+52,this.ctim,!0)}constructor(e,r,o){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=r,this.size=o}}const $e=0,Ke=1;class ye{static read_bytes(e,r){return new ye(e.getBigUint64(r,!0),e.getUint8(r+8),e.getUint32(r+16,!0),e.getBigUint64(r+24,!0),e.getUint16(r+36,!0))}constructor(e,r,o,u,t){this.userdata=e,this.eventtype=r,this.clockid=o,this.timeout=u,this.flags=t}}class Xe{write_bytes(e,r){e.setBigUint64(r,this.userdata,!0),e.setUint16(r+8,this.error,!0),e.setUint8(r+10,this.eventtype)}constructor(e,r,o){this.userdata=e,this.error=r,this.eventtype=o}}const qe=0;class Je{write_bytes(e,r){e.setUint32(r,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}}class we{static dir(e){const r=new we;return r.tag=qe,r.inner=new Je(e),r}write_bytes(e,r){e.setUint32(r,this.tag,!0),this.inner.write_bytes(e,r+4)}}let Qe=class{enable(e){this.log=et(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function et(A,e){return A?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const B=new Qe(!1);class Te extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let Re=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(r){if(r instanceof Te)return r.code;throw r}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,r,o,u={}){this.args=[],this.env=[],this.fds=[],B.enable(u.debug),this.args=e,this.env=r,this.fds=o;const t=this;this.wasiImport={args_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.args.length,!0);let a=0;for(const l of t.args)a+=l.length+1;return i.setUint32(s,a,!0),B.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},args_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),a=new Uint8Array(t.inst.exports.memory.buffer),l=s;for(let f=0;f<t.args.length;f++){i.setUint32(n,s,!0),n+=4;const _=new TextEncoder().encode(t.args[f]);a.set(_,s),i.setUint8(s+_.length,0),s+=_.length+1}return B.enabled&&B.log(new TextDecoder("utf-8").decode(a.slice(l,s))),0},environ_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.env.length,!0);let a=0;for(const l of t.env)a+=new TextEncoder().encode(l).length+1;return i.setUint32(s,a,!0),B.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},environ_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),a=new Uint8Array(t.inst.exports.memory.buffer),l=s;for(let f=0;f<t.env.length;f++){i.setUint32(n,s,!0),n+=4;const _=new TextEncoder().encode(t.env[f]);a.set(_,s),i.setUint8(s+_.length,0),s+=_.length+1}return B.enabled&&B.log(new TextDecoder("utf-8").decode(a.slice(l,s))),0},clock_res_get(n,s){let i;switch(n){case ue:{i=5000n;break}case fe:{i=1000000n;break}default:return He}return new DataView(t.inst.exports.memory.buffer).setBigUint64(s,i,!0),m},clock_time_get(n,s,i){const a=new DataView(t.inst.exports.memory.buffer);if(n===fe)a.setBigUint64(i,BigInt(new Date().getTime())*1000000n,!0);else if(n==ue){let l;try{l=BigInt(Math.round(performance.now()*1e6))}catch{l=0n}a.setBigUint64(i,l,!0)}else a.setBigUint64(i,0n,!0);return 0},fd_advise(n,s,i,a){return t.fds[n]!=null?m:h},fd_allocate(n,s,i){return t.fds[n]!=null?t.fds[n].fd_allocate(s,i):h},fd_close(n){if(t.fds[n]!=null){const s=t.fds[n].fd_close();return t.fds[n]=void 0,s}else return h},fd_datasync(n){return t.fds[n]!=null?t.fds[n].fd_sync():h},fd_fdstat_get(n,s){if(t.fds[n]!=null){const{ret:i,fdstat:a}=t.fds[n].fd_fdstat_get();return a!=null&&a.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return h},fd_fdstat_set_flags(n,s){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_flags(s):h},fd_fdstat_set_rights(n,s,i){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_rights(s,i):h},fd_filestat_get(n,s){if(t.fds[n]!=null){const{ret:i,filestat:a}=t.fds[n].fd_filestat_get();return a!=null&&a.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return h},fd_filestat_set_size(n,s){return t.fds[n]!=null?t.fds[n].fd_filestat_set_size(s):h},fd_filestat_set_times(n,s,i,a){return t.fds[n]!=null?t.fds[n].fd_filestat_set_times(s,i,a):h},fd_pread(n,s,i,a,l){const f=new DataView(t.inst.exports.memory.buffer),_=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=J.read_bytes_array(f,s,i);let p=0;for(const c of d){const{ret:g,data:v}=t.fds[n].fd_pread(c.buf_len,a);if(g!=m)return f.setUint32(l,p,!0),g;if(_.set(v,c.buf),p+=v.length,a+=BigInt(v.length),v.length!=c.buf_len)break}return f.setUint32(l,p,!0),m}else return h},fd_prestat_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:a,prestat:l}=t.fds[n].fd_prestat_get();return l!=null&&l.write_bytes(i,s),a}else return h},fd_prestat_dir_name(n,s,i){if(t.fds[n]!=null){const{ret:a,prestat:l}=t.fds[n].fd_prestat_get();if(l==null)return a;const f=l.inner.pr_name;return new Uint8Array(t.inst.exports.memory.buffer).set(f.slice(0,i),s),f.byteLength>i?We:m}else return h},fd_pwrite(n,s,i,a,l){const f=new DataView(t.inst.exports.memory.buffer),_=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=Q.read_bytes_array(f,s,i);let p=0;for(const c of d){const g=_.slice(c.buf,c.buf+c.buf_len),{ret:v,nwritten:O}=t.fds[n].fd_pwrite(g,a);if(v!=m)return f.setUint32(l,p,!0),v;if(p+=O,a+=BigInt(O),O!=g.byteLength)break}return f.setUint32(l,p,!0),m}else return h},fd_read(n,s,i,a){const l=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const _=J.read_bytes_array(l,s,i);let d=0;for(const p of _){const{ret:c,data:g}=t.fds[n].fd_read(p.buf_len);if(c!=m)return l.setUint32(a,d,!0),c;if(f.set(g,p.buf),d+=g.length,g.length!=p.buf_len)break}return l.setUint32(a,d,!0),m}else return h},fd_readdir(n,s,i,a,l){const f=new DataView(t.inst.exports.memory.buffer),_=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){let d=0;for(;;){const{ret:p,dirent:c}=t.fds[n].fd_readdir_single(a);if(p!=0)return f.setUint32(l,d,!0),p;if(c==null)break;if(i-d<c.head_length()){d=i;break}const g=new ArrayBuffer(c.head_length());if(c.write_head_bytes(new DataView(g),0),_.set(new Uint8Array(g).slice(0,Math.min(g.byteLength,i-d)),s),s+=c.head_length(),d+=c.head_length(),i-d<c.name_length()){d=i;break}c.write_name_bytes(_,s,i-d),s+=c.name_length(),d+=c.name_length(),a=c.d_next}return f.setUint32(l,d,!0),0}else return h},fd_renumber(n,s){if(t.fds[n]!=null&&t.fds[s]!=null){const i=t.fds[s].fd_close();return i!=0?i:(t.fds[s]=t.fds[n],t.fds[n]=void 0,0)}else return h},fd_seek(n,s,i,a){const l=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:f,offset:_}=t.fds[n].fd_seek(s,i);return l.setBigInt64(a,_,!0),f}else return h},fd_sync(n){return t.fds[n]!=null?t.fds[n].fd_sync():h},fd_tell(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:a,offset:l}=t.fds[n].fd_tell();return i.setBigUint64(s,l,!0),a}else return h},fd_write(n,s,i,a){const l=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const _=Q.read_bytes_array(l,s,i);let d=0;for(const p of _){const c=f.slice(p.buf,p.buf+p.buf_len),{ret:g,nwritten:v}=t.fds[n].fd_write(c);if(g!=m)return l.setUint32(a,d,!0),g;if(d+=v,v!=c.byteLength)break}return l.setUint32(a,d,!0),m}else return h},path_create_directory(n,s,i){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(s,s+i));return t.fds[n].path_create_directory(l)}else return h},path_filestat_get(n,s,i,a,l){const f=new DataView(t.inst.exports.memory.buffer),_=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=new TextDecoder("utf-8").decode(_.slice(i,i+a)),{ret:p,filestat:c}=t.fds[n].path_filestat_get(s,d);return c!=null&&c.write_bytes(f,l),p}else return h},path_filestat_set_times(n,s,i,a,l,f,_){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(d.slice(i,i+a));return t.fds[n].path_filestat_set_times(s,p,l,f,_)}else return h},path_link(n,s,i,a,l,f,_){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[l]!=null){const p=new TextDecoder("utf-8").decode(d.slice(i,i+a)),c=new TextDecoder("utf-8").decode(d.slice(f,f+_)),{ret:g,inode_obj:v}=t.fds[n].path_lookup(p,s);return v==null?g:t.fds[l].path_link(c,v,!1)}else return h},path_open(n,s,i,a,l,f,_,d,p){const c=new DataView(t.inst.exports.memory.buffer),g=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const v=new TextDecoder("utf-8").decode(g.slice(i,i+a));B.log(v);const{ret:O,fd_obj:ee}=t.fds[n].path_open(s,v,l,f,_,d);if(O!=0)return O;t.fds.push(ee);const se=t.fds.length-1;return c.setUint32(p,se,!0),0}else return h},path_readlink(n,s,i,a,l,f){const _=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(d.slice(s,s+i));B.log(p);const{ret:c,data:g}=t.fds[n].path_readlink(p);if(g!=null){const v=new TextEncoder().encode(g);if(v.length>l)return _.setUint32(f,0,!0),h;d.set(v,a),_.setUint32(f,v.length,!0)}return c}else return h},path_remove_directory(n,s,i){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(s,s+i));return t.fds[n].path_remove_directory(l)}else return h},path_rename(n,s,i,a,l,f){const _=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[a]!=null){const d=new TextDecoder("utf-8").decode(_.slice(s,s+i)),p=new TextDecoder("utf-8").decode(_.slice(l,l+f));let{ret:c,inode_obj:g}=t.fds[n].path_unlink(d);if(g==null)return c;if(c=t.fds[a].path_link(p,g,!0),c!=m&&t.fds[n].path_link(d,g,!0)!=m)throw"path_link should always return success when relinking an inode back to the original place";return c}else return h},path_symlink(n,s,i,a,l){const f=new Uint8Array(t.inst.exports.memory.buffer);return t.fds[i]!=null?(new TextDecoder("utf-8").decode(f.slice(n,n+s)),new TextDecoder("utf-8").decode(f.slice(a,a+l)),w):h},path_unlink_file(n,s,i){const a=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const l=new TextDecoder("utf-8").decode(a.slice(s,s+i));return t.fds[n].path_unlink_file(l)}else return h},poll_oneoff(n,s,i){if(i===0)return G;if(i>1)return B.log("poll_oneoff: only a single subscription is supported"),w;const a=new DataView(t.inst.exports.memory.buffer),l=ye.read_bytes(a,n),f=l.eventtype,_=l.clockid,d=l.timeout;if(f!==$e)return B.log("poll_oneoff: only clock subscriptions are supported"),w;let p;if(_===ue)p=()=>BigInt(Math.round(performance.now()*1e6));else if(_===fe)p=()=>BigInt(new Date().getTime())*1000000n;else return G;const c=(l.flags&Ke)!==0?d:p()+d;for(;c>p(););return new Xe(l.userdata,m,f).write_bytes(a,s),m},proc_exit(n){throw new Te(n)},proc_raise(n){throw"raised signal "+n},sched_yield(){},random_get(n,s){const i=new Uint8Array(t.inst.exports.memory.buffer).subarray(n,n+s);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(t.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let a=0;a<s;a+=65536)crypto.getRandomValues(i.subarray(a,a+65536));else for(let a=0;a<s;a++)i[a]=Math.random()*256|0},sock_recv(n,s,i){throw"sockets not supported"},sock_send(n,s,i){throw"sockets not supported"},sock_shutdown(n,s){throw"sockets not supported"},sock_accept(n,s){throw"sockets not supported"}}}};class be{fd_allocate(e,r){return w}fd_close(){return 0}fd_fdstat_get(){return{ret:w,fdstat:null}}fd_fdstat_set_flags(e){return w}fd_fdstat_set_rights(e,r){return w}fd_filestat_get(){return{ret:w,filestat:null}}fd_filestat_set_size(e){return w}fd_filestat_set_times(e,r,o){return w}fd_pread(e,r){return{ret:w,data:new Uint8Array}}fd_prestat_get(){return{ret:w,prestat:null}}fd_pwrite(e,r){return{ret:w,nwritten:0}}fd_read(e){return{ret:w,data:new Uint8Array}}fd_readdir_single(e){return{ret:w,dirent:null}}fd_seek(e,r){return{ret:w,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:w,offset:0n}}fd_write(e){return{ret:w,nwritten:0}}path_create_directory(e){return w}path_filestat_get(e,r){return{ret:w,filestat:null}}path_filestat_set_times(e,r,o,u,t){return w}path_link(e,r,o){return w}path_unlink(e){return{ret:w,inode_obj:null}}path_lookup(e,r){return{ret:w,inode_obj:null}}path_open(e,r,o,u,t,n){return{ret:j,fd_obj:null}}path_readlink(e){return{ret:w,data:null}}path_remove_directory(e){return w}path_rename(e,r,o){return w}path_unlink_file(e){return w}}class M{static issue_ino(){return M.next_ino++}static root_ino(){return 0n}constructor(){this.ino=M.issue_ino()}}M.next_ino=1n;class pe extends be{fd_allocate(e,r){if(!(this.file.size>e+r)){const o=new Uint8Array(Number(e+r));o.set(this.file.data,0),this.file.data=o}return m}fd_fdstat_get(){return{ret:0,fdstat:new ge(re,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const r=new Uint8Array(Number(e));r.set(this.file.data,0),this.file.data=r}return m}fd_read(e){const r=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(r.length),{ret:0,data:r}}fd_pread(e,r){return{ret:0,data:this.file.data.slice(Number(r),Number(r+BigInt(e)))}}fd_seek(e,r){let o;switch(r){case Ge:o=e;break;case Ye:o=this.file_pos+e;break;case Le:o=BigInt(this.file.data.byteLength)+e;break;default:return{ret:G,offset:0n}}return o<0?{ret:G,offset:0n}:(this.file_pos=o,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:h,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(r)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,r){if(this.file.readonly)return{ret:h,nwritten:0};if(r+BigInt(e.byteLength)>this.file.size){const o=this.file.data;this.file.data=new Uint8Array(Number(r+BigInt(e.byteLength))),this.file.data.set(o)}return this.file.data.set(e,Number(r)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class ze extends be{fd_seek(e,r){return{ret:h,offset:0n}}fd_tell(){return{ret:h,offset:0n}}fd_allocate(e,r){return h}fd_fdstat_get(){return{ret:0,fdstat:new ge(R,0)}}fd_readdir_single(e){if(B.enabled&&(B.log("readdir_single",e),B.log(e,this.dir.contents.keys())),e==0n)return{ret:m,dirent:new de(1n,this.dir.ino,".",R)};if(e==1n)return{ret:m,dirent:new de(2n,this.dir.parent_ino(),"..",R)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[r,o]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new de(e+1n,o.ino,r,o.stat().filetype)}}path_filestat_get(e,r){const{ret:o,path:u}=S.from(r);if(u==null)return{ret:o,filestat:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(u);return n==null?{ret:t,filestat:null}:{ret:0,filestat:n.stat()}}path_lookup(e,r){const{ret:o,path:u}=S.from(e);if(u==null)return{ret:o,inode_obj:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(u);return n==null?{ret:t,inode_obj:null}:{ret:m,inode_obj:n}}path_open(e,r,o,u,t,n){const{ret:s,path:i}=S.from(r);if(i==null)return{ret:s,fd_obj:null};let{ret:a,entry:l}=this.dir.get_entry_for_path(i);if(l==null){if(a!=P)return{ret:a,fd_obj:null};if((o&ce)==ce){const{ret:f,entry:_}=this.dir.create_entry_for_path(r,(o&q)==q);if(_==null)return{ret:f,fd_obj:null};l=_}else return{ret:P,fd_obj:null}}else if((o&Ae)==Ae)return{ret:ne,fd_obj:null};return(o&q)==q&&l.stat().filetype!==R?{ret:j,fd_obj:null}:l.path_open(o,u,n)}path_create_directory(e){return this.path_open(0,e,ce|q,0n,0n,0).ret}path_link(e,r,o){const{ret:u,path:t}=S.from(e);if(t==null)return u;if(t.is_dir)return P;const{ret:n,parent_entry:s,filename:i,entry:a}=this.dir.get_parent_dir_and_entry_for_path(t,!0);if(s==null||i==null)return n;if(a!=null){const l=r.stat().filetype==R,f=a.stat().filetype==R;if(l&&f)if(o&&a instanceof C){if(a.contents.size!=0)return ke}else return ne;else{if(l&&!f)return j;if(!l&&f)return Ue;if(!(r.stat().filetype==re&&a.stat().filetype==re))return ne}}return!o&&r.stat().filetype==R?_e:(s.contents.set(i,r),m)}path_unlink(e){const{ret:r,path:o}=S.from(e);if(o==null)return{ret:r,inode_obj:null};const{ret:u,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!0);return t==null||n==null?{ret:u,inode_obj:null}:s==null?{ret:P,inode_obj:null}:(t.contents.delete(n),{ret:m,inode_obj:s})}path_unlink_file(e){const{ret:r,path:o}=S.from(e);if(o==null)return r;const{ret:u,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?u:s.stat().filetype===R?Ue:(t.contents.delete(n),m)}path_remove_directory(e){const{ret:r,path:o}=S.from(e);if(o==null)return r;const{ret:u,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?u:!(s instanceof C)||s.stat().filetype!==R?j:s.contents.size!==0?ke:t.contents.delete(n)?m:P}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return h}fd_read(e){return{ret:h,data:new Uint8Array}}fd_pread(e,r){return{ret:h,data:new Uint8Array}}fd_write(e){return{ret:h,nwritten:0}}fd_pwrite(e,r){return{ret:h,nwritten:0}}constructor(e){super(),this.dir=e}}class te extends ze{fd_prestat_get(){return{ret:0,prestat:we.dir(this.prestat_name)}}constructor(e,r){super(new C(r)),this.prestat_name=e}}class W extends M{path_open(e,r,o){if(this.readonly&&(r&BigInt(he))==BigInt(he))return{ret:_e,fd_obj:null};if((e&De)==De){if(this.readonly)return{ret:_e,fd_obj:null};this.data=new Uint8Array([])}const u=new pe(this);return o&Ze&&u.fd_seek(0n,Le),{ret:m,fd_obj:u}}get size(){return BigInt(this.data.byteLength)}stat(){return new me(this.ino,re,this.size)}constructor(e,r){super(),this.data=new Uint8Array(e),this.readonly=!!(r!=null&&r.readonly)}}let S=class Ne{static from(e){const r=new Ne;if(r.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:Ee,path:null};if(e.includes("\0"))return{ret:G,path:null};for(const o of e.split("/"))if(!(o===""||o===".")){if(o===".."){if(r.parts.pop()==null)return{ret:Ee,path:null};continue}r.parts.push(o)}return{ret:m,path:r}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}constructor(){this.parts=[],this.is_dir=!1}};class C extends M{parent_ino(){return this.parent==null?M.root_ino():this.parent.ino}path_open(e,r,o){return{ret:m,fd_obj:new ze(this)}}stat(){return new me(this.ino,R,0n)}get_entry_for_path(e){let r=this;for(const o of e.parts){if(!(r instanceof C))return{ret:j,entry:null};const u=r.contents.get(o);if(u!==void 0)r=u;else return B.log(o),{ret:P,entry:null}}return e.is_dir&&r.stat().filetype!=R?{ret:j,entry:null}:{ret:m,entry:r}}get_parent_dir_and_entry_for_path(e,r){const o=e.parts.pop();if(o===void 0)return{ret:G,parent_entry:null,filename:null,entry:null};const{ret:u,entry:t}=this.get_entry_for_path(e);if(t==null)return{ret:u,parent_entry:null,filename:null,entry:null};if(!(t instanceof C))return{ret:j,parent_entry:null,filename:null,entry:null};const n=t.contents.get(o);return n===void 0?r?{ret:m,parent_entry:t,filename:o,entry:null}:{ret:P,parent_entry:null,filename:null,entry:null}:e.is_dir&&n.stat().filetype!=R?{ret:j,parent_entry:null,filename:null,entry:null}:{ret:m,parent_entry:t,filename:o,entry:n}}create_entry_for_path(e,r){const{ret:o,path:u}=S.from(e);if(u==null)return{ret:o,entry:null};let{ret:t,parent_entry:n,filename:s,entry:i}=this.get_parent_dir_and_entry_for_path(u,!0);if(n==null||s==null)return{ret:t,entry:null};if(i!=null)return{ret:ne,entry:null};B.log("create",u);let a;return r?a=new C(new Map):a=new W(new ArrayBuffer(0)),n.contents.set(s,a),i=a,{ret:m,entry:i}}constructor(e){super(),this.parent=null,e instanceof Array?this.contents=new Map(e):this.contents=e;for(const r of this.contents.values())r instanceof C&&(r.parent=this)}}class H extends be{fd_filestat_get(){return{ret:0,filestat:new me(this.ino,Be,BigInt(0))}}fd_fdstat_get(){const e=new ge(Be,0);return e.fs_rights_base=BigInt(he),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const r=new TextDecoder("utf-8",{fatal:!1});let o="";return new H(u=>{o+=r.decode(u,{stream:!0});const t=o.split(`
`);for(const[n,s]of t.entries())n<t.length-1?e(s):o=s})}constructor(e){super(),this.ino=M.issue_ino(),this.write=e}}const tt={class:"flex flex-col md:flex-row h-full"},nt={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},rt={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},st={class:"flex items-center gap-4"},it={class:"flex items-center gap-2"},at={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},ot={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},lt={class:"relative group"},ft=["label"],ut=["value"],dt=["disabled"],ct={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_t={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},ht={class:"flex-1 min-h-0"},pt={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},gt={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},mt={class:"flex items-center gap-3"},yt={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},wt={key:0,class:"text-xs text-slate-500"},bt={key:0,class:"flex-1 flex items-center justify-center"},xt={class:"text-center space-y-4"},vt={class:"text-slate-400"},Ut={key:1,class:"flex-1 overflow-y-auto p-4 font-mono text-sm space-y-1"},kt={key:0,class:"text-red-400"},Et={key:1,class:"text-emerald-400"},Bt={class:"whitespace-pre-wrap"},At={key:0,class:"text-slate-500 italic"},Ct={__name:"ZigRunner",emits:["ready"],setup(A,{emit:e}){const{t:r}=Ie(),o=N(""),u=N(""),t=N(null),n=N([]),s=N(!1),i=N(!1),a=N(!1),l=N(""),f=N(null),_=async()=>{try{const b=await Fe("zig");if(t.value=b,b.chapters&&b.chapters.length>0&&b.chapters[0].examples.length>0){const y=b.chapters[0].examples[0];u.value=y.path,o.value=await ve("zig",y.path)}}catch(b){console.error("Failed to load Zig manifest:",b)}};let d=null,p=null;function c(b){return new C(new Map([...b.entries()].map(([y,D])=>D instanceof Map?[y,c(D)]:[y,new W(D)])))}const g=async()=>{if(!a.value){s.value=!0,n.value=[];try{const b="/tools/",y=`${b.endsWith("/")?b:b+"/"}zig-wasm/`;l.value="Loading Zig Compiler...";const D=await fetch(`${y}zig.wasm`);if(!D.ok)throw new Error(`Failed to fetch zig.wasm: ${D.statusText}`);d=await D.arrayBuffer(),l.value="Loading Standard Library...";const U=await fetch(`${y}zig.tar.gz`);if(!U.ok)throw new Error(`Failed to fetch zig.tar.gz: ${U.statusText}`);let T=await U.arrayBuffer();l.value="Extracting Standard Library...";const Y=new Uint8Array(T).slice(0,2);if(Y[0]===31&&Y[1]===139){const V=new DecompressionStream("gzip"),z=new Response(T).body.pipeThrough(V);T=await new Response(z).arrayBuffer()}const ie=Pe.untar(T),Z=new Map;for(const V of ie){let z=V.filename;if(z.startsWith("zig-out/lib/")&&(z=z.slice(8)),!z.startsWith("lib/"))continue;const $=z.slice(4);if(!$)continue;const K=$.split("/");let F=Z;for(const L of K.slice(0,-1))F.has(L)||F.set(L,new Map),F=F.get(L);F.set(K[K.length-1],V.fileData)}p=c(Z),a.value=!0,l.value=""}catch(b){console.error("Zig load failed",b),n.value.push({type:"error",message:"Failed to load Zig runtime: "+b.message})}finally{s.value=!1}}},v=async()=>{if(a.value||await g(),!(!d||!p)){i.value=!0,n.value=[],f.value=null;try{const b=performance.now(),y=new Map;y.set("main.zig",new W(new TextEncoder().encode(o.value)));const D=[new pe(new W([])),H.lineBuffered(L=>n.value.push({type:"log",message:L})),H.lineBuffered(L=>n.value.push({type:"error",message:L})),new te(".",y),new te("/lib",p.contents),new te("/cache",new Map)],U=["zig.wasm","build-exe","main.zig","-fno-llvm","-fno-lld","-fno-ubsan-rt","-fno-entry"],T=[],Y=new Re(U,T,D,{debug:!1}),{instance:ie}=await WebAssembly.instantiate(d,{wasi_snapshot_preview1:Y.wasiImport}),Z=Y.start(ie);if(Z!==0)throw new Error(`Compilation failed (Exit Code: ${Z})`);const V=y.get("main.wasm");if(!V||!(V instanceof W))throw new Error("Compilation successful but 'main.wasm' not found.");n.value.push({type:"log",message:"Compilation successful. Running..."});const z=[new pe(new W([])),H.lineBuffered(L=>n.value.push({type:"log",message:L})),H.lineBuffered(L=>n.value.push({type:"error",message:L})),new te(".",new Map)],$=new Re(["main.wasm"],[],z,{debug:!1}),{instance:K}=await WebAssembly.instantiate(V.data,{wasi_snapshot_preview1:$.wasiImport});$.start(K);const F=performance.now();f.value=(F-b).toFixed(2)}catch(b){n.value.push({type:"error",message:b.message}),console.error(b)}finally{i.value=!1}}},O=async()=>{if(u.value){ee();try{s.value=!0,l.value="Loading example...",o.value=await ve("zig",u.value)}catch(b){n.value.push({type:"error",message:`Failed to load example: ${b.message}`})}finally{s.value=!1,l.value=""}}},ee=()=>{n.value=[],f.value=null},se=b=>b==="error"?"text-red-400":"text-emerald-400";return Ce(()=>{g(),_()}),(b,y)=>{var D;return E(),k("div",tt,[x("div",nt,[x("div",rt,[x("div",st,[x("div",it,[y[2]||(y[2]=x("svg",{class:"w-5 h-5 text-orange-400",viewBox:"0 0 128 128",fill:"currentColor"},[x("path",{d:"M12.94 13.916 2.08 26.657h111.45L128 13.916H12.94zm-1.89 12.74L0 39.398l112.52.09L124.96 26.657H11.05zm-.1 38.648-9.98 12.74 125.86.095L115.82 65.304H10.95zm-1.63 12.74L0 90.785l114.73.09 11.23-12.83H9.32zm9.15 12.74L7.54 116.265h111.45l1.43-12.74H18.47z"})],-1)),y[3]||(y[3]=x("span",{class:"font-bold text-white"},"Zig",-1)),a.value?(E(),k("span",at,I(X(r)("tools.code-playground.common.ready")),1)):s.value?ae("",!0):(E(),k("span",ot,I(X(r)("tools.code-playground.common.not_loaded")),1))]),x("div",lt,[Oe(x("select",{"onUpdate:modelValue":y[0]||(y[0]=U=>u.value=U),onChange:O,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all cursor-pointer"},[(E(!0),k(oe,null,le((D=t.value)==null?void 0:D.chapters,U=>(E(),k("optgroup",{key:U.title,label:U.title},[(E(!0),k(oe,null,le(U.examples,T=>(E(),k("option",{key:T.path,value:T.path},I(T.name),9,ut))),128))],8,ft))),128))],544),[[Ve,u.value]]),y[4]||(y[4]=x("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[x("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),x("button",{onClick:v,disabled:s.value||i.value,class:xe(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",s.value||i.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-emerald-600 hover:bg-emerald-500 text-white"])},[s.value||i.value?(E(),k("svg",ct,[...y[5]||(y[5]=[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(E(),k("svg",_t,[...y[6]||(y[6]=[x("path",{d:"M8 5v14l11-7z"},null,-1)])])),Se(" "+I(s.value?"Loading...":i.value?"Running...":X(r)("tools.code-playground.common.run")),1)],10,dt)]),x("div",ht,[je(Me,{modelValue:o.value,"onUpdate:modelValue":y[1]||(y[1]=U=>o.value=U),language:"zig",height:"100%",minimap:!1},null,8,["modelValue"])])]),x("div",pt,[x("div",gt,[x("div",mt,[x("span",yt,I(X(r)("tools.code-playground.common.output")),1),f.value?(E(),k("span",wt,I(f.value)+"ms",1)):ae("",!0)]),x("button",{onClick:ee,class:"text-xs text-slate-500 hover:text-white transition-colors"},I(X(r)("tools.code-playground.common.clear")),1)]),s.value?(E(),k("div",bt,[x("div",xt,[y[7]||(y[7]=x("div",{class:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),x("div",vt,I(l.value),1)])])):(E(),k("div",Ut,[(E(!0),k(oe,null,le(n.value,(U,T)=>(E(),k("div",{key:T,class:xe(["flex items-start gap-2",se(U.type)])},[U.type==="error"?(E(),k("span",kt,"✗")):(E(),k("span",Et,"›")),x("span",Bt,I(U.message),1)],2))),128)),n.value.length===0&&!s.value&&!i.value?(E(),k("div",At,' Click "Run" to execute Zig code... ')):ae("",!0)]))])])}}};export{Ct as default};
