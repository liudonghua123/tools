import{_ as B}from"./monaco-editor-DrHUTMTD.js";import{_ as S,u as $,r as i,o as H,c as l,j as r,d as t,g as C,t as d,e as g,h as W,s as D,F as y,f as b,b as R,n as T}from"./index-3W9u9xF1.js";import I from"./MonacoEditor-DFCuHsc7.js";import{f as N,a as E}from"./ExampleLoader-C0CuCz3g.js";const O={class:"flex flex-col md:flex-row h-full"},U={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},q={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},G={class:"flex items-center gap-4"},J={class:"flex items-center gap-2"},K={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},Q={class:"relative group"},X=["label"],Y=["value"],Z=["disabled"],ee={class:"flex-1 min-h-0"},te={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},se={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},ae={class:"flex items-center gap-3"},oe={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},le={key:0,class:"text-xs text-slate-500"},re={key:0,class:"flex-1 flex items-center justify-center"},ne={class:"text-center space-y-4"},ie={class:"text-slate-400"},de={key:1,class:"flex-1 overflow-y-auto p-4 font-mono text-sm space-y-1"},ce={key:0,class:"text-red-400"},ue={key:1,class:"text-slate-500"},pe={key:2,class:"text-blue-400"},me={class:"whitespace-pre-wrap"},he={__name:"PhpRunner",emits:["output","error","ready"],setup(ve,{emit:L}){const{t:x}=$(),j=L,m=i(""),w=i(null),h=i(""),n=i([]),c=i(!1),P=i(!1),v=i(""),f=i(null);let u=null;const M=async()=>{try{const e=await N("php");if(w.value=e,e.chapters&&e.chapters.length>0&&e.chapters[0].examples.length>0){const a=e.chapters[0].examples[0];h.value=a.path,m.value=await E("php",a.path)}}catch(e){console.error("Failed to load PHP manifest:",e),n.value.push({type:"error",message:`Failed to load examples manifest: ${e.message}`})}},V=async()=>{if(u)return u;console.log("Loading PHP runtime..."),c.value=!0,v.value="Loading PHP runtime...";try{const e="/tools/",a=`${e.endsWith("/")?e:e+"/"}php-wasm/`,{PhpWeb:p}=await B(async()=>{const{PhpWeb:s}=await import(`${a}PhpWeb.mjs`);return{PhpWeb:s}},[]);return u=new p,u.addEventListener("output",s=>{const o=s.detail,_=Array.isArray(o)?o.join(""):String(o);n.value.push({type:"log",message:_})}),u.addEventListener("error",s=>{const o=s.detail,_=Array.isArray(o)?o.join(""):String(o);n.value.push({type:"error",message:_})}),new Promise((s,o)=>{u.addEventListener("ready",()=>{P.value=!0,j("ready"),s(u)})})}catch(e){return n.value.push({type:"error",message:`Failed to load PHP: ${e.message}`}),Promise.reject(e)}finally{c.value=!1,v.value=""}},z=async()=>{if(h.value){k();try{c.value=!0,v.value="Loading example...",m.value=await E("php",h.value)}catch(e){n.value.push({type:"error",message:`Failed to load example: ${e.message}`})}finally{c.value=!1,v.value=""}}},F=async()=>{n.value=[],f.value=null;try{const e=await V(),a=performance.now();let p=m.value.replace(/\r/g,"");const s=await e.run(p),o=performance.now();f.value=(o-a).toFixed(2),n.value.push({type:"info",message:`Program exited with code ${s}`})}catch(e){n.value.push({type:"error",message:e.message})}},k=()=>{n.value=[],f.value=null},A=e=>e==="error"?"text-red-400":e==="info"?"text-slate-500 italic":"text-blue-400";return H(()=>{M()}),(e,a)=>{var p;return r(),l("div",O,[t("div",U,[t("div",q,[t("div",G,[t("div",J,[a[2]||(a[2]=t("svg",{class:"w-5 h-5 text-indigo-400",viewBox:"0 0 128 128",fill:"currentColor"},[t("path",{d:"M64 30.332C28.654 30.332 0 45.407 0 64s28.654 33.668 64 33.668c35.345 0 64-15.075 64-33.668S99.346 30.332 64 30.332zm-5.982 9.81h7.293v.003l-1.745 8.968h6.496c4.087 0 6.908.714 8.458 2.139 1.553 1.427 2.017 3.737 1.398 6.93l-3.053 15.7h-7.408l2.902-14.929c.33-1.698.208-2.855-.365-3.473-.573-.617-1.793-.925-3.658-.925h-5.828L58.752 73.88h-7.291l6.557-33.738zM26.73 49.114h14.133c4.252 0 7.355 1.116 9.305 3.348 1.95 2.232 2.536 5.346 1.758 9.346-.32 1.649-.863 3.154-1.625 4.52-.763 1.364-1.76 2.613-2.99 3.745-1.468 1.373-3.098 2.353-4.891 2.936-1.794.585-4.08.875-6.858.875h-6.294l-1.745 8.97h-7.35l6.557-33.74zm57.366 0h14.13c4.252 0 7.353 1.116 9.303 3.348h.002c1.95 2.232 2.538 5.346 1.76 9.346-.32 1.649-.861 3.154-1.623 4.52-.763 1.364-1.76 2.613-2.992 3.745-1.467 1.373-3.098 2.353-4.893 2.936-1.794.585-4.077.875-6.855.875h-6.295l-1.744 8.97h-7.35l6.557-33.74zm-51.051 5.325-2.742 14.12h4.468c2.963 0 5.172-.556 6.622-1.673 1.45-1.116 2.428-2.981 2.937-5.592.485-2.507.264-4.279-.666-5.309-.93-1.032-2.79-1.547-5.584-1.547h-5.035zm57.363 0-2.744 14.12h4.47c2.965 0 5.17-.556 6.622-1.673 1.449-1.116 2.427-2.981 2.935-5.592.487-2.507.266-4.279-.664-5.309-.93-1.032-2.792-1.547-5.584-1.547h-5.035z"})],-1)),a[3]||(a[3]=t("span",{class:"font-bold text-white"},"PHP (WASM)",-1)),P.value?(r(),l("span",K,d(g(x)("tools.code-playground.common.ready")),1)):C("",!0)]),t("div",Q,[W(t("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>h.value=s),onChange:z,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 transition-all cursor-pointer"},[(r(!0),l(y,null,b(((p=w.value)==null?void 0:p.chapters)||[],s=>(r(),l("optgroup",{key:s.title,label:s.title},[(r(!0),l(y,null,b(s.examples||[],o=>(r(),l("option",{key:o.path,value:o.path},d(o.name),9,Y))),128))],8,X))),128))],544),[[D,h.value]]),a[4]||(a[4]=t("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),t("button",{onClick:F,disabled:c.value,class:"px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2 bg-emerald-600 hover:bg-emerald-500 text-white disabled:bg-slate-600 disabled:text-slate-400"},d(c.value?"Loading...":g(x)("tools.code-playground.common.run")),9,Z)]),t("div",ee,[R(I,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=s=>m.value=s),language:"php",height:"100%"},null,8,["modelValue"])])]),t("div",te,[t("div",se,[t("div",ae,[t("span",oe,d(g(x)("tools.code-playground.common.output")),1),f.value?(r(),l("span",le,d(f.value)+"ms",1)):C("",!0)]),t("button",{onClick:k,class:"text-xs text-slate-500 hover:text-white"},d(g(x)("tools.code-playground.common.clear")),1)]),c.value?(r(),l("div",re,[t("div",ne,[a[5]||(a[5]=t("div",{class:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),t("div",ie,d(v.value),1)])])):(r(),l("div",de,[(r(!0),l(y,null,b(n.value,(s,o)=>(r(),l("div",{key:o,class:T(["flex items-start gap-2",A(s.type)])},[s.type==="error"?(r(),l("span",ce,"✗")):s.type==="info"?(r(),l("span",ue,"ℹ")):(r(),l("span",pe,"›")),t("span",me,d(s.message),1)],2))),128))]))])])}}},ye=S(he,[["__scopeId","data-v-239c7d12"]]);export{ye as default};
