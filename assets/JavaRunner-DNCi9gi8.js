import{u as te,r as i,o as se,a as ae,l as I,c as o,j as l,d as t,g as $,t as n,e as g,h as O,s as T,F as E,f as V,n as N,i as oe,b as le}from"./index-hw7nIlup.js";import ne from"./MonacoEditor-D1-m5bfC.js";import{f as re,a as L}from"./ExampleLoader-C0CuCz3g.js";import"./monaco-editor-DrHUTMTD.js";const ie={class:"flex flex-col md:flex-row h-full"},ce={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},ue={class:"flex flex-wrap items-center justify-between gap-2 px-4 py-3 border-b border-slate-700 bg-slate-800/50"},de={class:"flex items-center gap-2"},pe={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},me={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},ve={class:"flex items-center gap-4"},fe={class:"flex items-center gap-2"},xe={class:"text-xs text-slate-400"},ge=["disabled"],he={class:"flex items-center gap-2"},ye={class:"text-xs text-slate-400"},we={class:"relative group"},be=["label"],_e=["value"],je=["disabled"],Ce={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ke={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},Je={class:"flex-1 min-h-0"},ze={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},Me={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},$e={class:"flex items-center gap-3"},Ee={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},Ve={key:0,class:"text-xs text-slate-500"},Ne={key:0,class:"flex-1 flex items-center justify-center"},Fe={class:"text-center space-y-4"},Se={class:"text-slate-400"},Ae={key:1,class:"flex-1 overflow-y-auto p-4 font-mono text-sm space-y-1"},Be={class:"whitespace-pre-wrap"},Re={key:0,class:"text-slate-500 italic"},De={__name:"JavaRunner",emits:["output","error","ready"],setup(Ie,{emit:U}){const{t:c}=te(),J=U,D={8:"ecj-3.26.0.jar",11:"ecj-3.33.0.jar",17:"ecj-3.44.0.jar"},z=i(8),h=i(""),F=i(null),y=i(""),w=i([]),d=i(!1),b=i(!1),x=i(""),_=i(null),j=i(!1),C=i(!1);let M=null;const P=async()=>{try{const s=await re("java");if(F.value=s,s.chapters&&s.chapters.length>0&&s.chapters[0].examples.length>0){const e=s.chapters[0].examples[0];h.value=e.path,y.value=await L("java",e.path)}}catch(s){console.error("Failed to load Java manifest:",s)}},r=(s,e="log")=>{w.value.push({type:e,message:s})},Z=async s=>{if(b.value)return M!==s?(r(`CheerpJ is already initialized with Java ${M}. To use Java ${s}, please refresh the page.`,"warning"),!1):!0;d.value=!0,x.value=`Loading CheerpJ runtime (Java ${s})...`;try{return window.cheerpjInit||await new Promise((e,u)=>{const a=document.createElement("script");a.src="https://cjrtnc.leaningtech.com/4.2/loader.js",a.onload=e,a.onerror=()=>u(new Error("Failed to load CheerpJ")),document.head.appendChild(a)}),x.value=`Initializing Java ${s} environment...`,await window.cheerpjInit({version:s,status:"none"}),M=s,b.value=!0,J("ready"),!0}catch(e){return e.message.includes("Already initialized")?(b.value=!0,!0):(r(`Failed to initialize CheerpJ: ${e.message}`,"error"),J("error",e),!1)}finally{d.value=!1,x.value=""}},H=s=>{const e=s.match(/public\s+class\s+([a-zA-Z_$][a-zA-Z\d_$]*)/);if(e)return e[1];const u=s.match(/class\s+([a-zA-Z_$][a-zA-Z\d_$]*)/);return u?u[1]:"Main"},q=async()=>{w.value=[],_.value=null;const s=z.value;try{if(!await Z(s))return;j.value=!0,r("Compiling...","info");const e=performance.now(),u=y.value,a=H(u),p=`/str/${a}.java`;window.cheerpOSAddStringFile(p,u);const W="/tools/",X=D[s],Y=`/app${W}ecj/${X}`,ee=await window.cheerpjRunMain("org.eclipse.jdt.internal.compiler.batch.Main",Y,p,"-d","/files/","-source",s,"-target",s);if(j.value=!1,ee===0){r("Compilation successful!","success"),C.value=!0,r("Running...","info");const B=console.log,R=console.error;console.log=(...m)=>{const v=m.map(f=>typeof f=="object"?JSON.stringify(f):String(f)).join(" ");v.trim()&&(r(v),B.apply(console,m))},console.error=(...m)=>{const v=m.map(f=>typeof f=="object"?JSON.stringify(f):String(f)).join(" ");v.trim()&&(r(v,"error"),R.apply(console,m))};try{const m=await window.cheerpjRunMain(a,"/files/");C.value=!1;const v=performance.now();_.value=(v-e).toFixed(2),m!==0&&r(`Program exited with code ${m}`,"warning")}finally{console.log=B,console.error=R}}else r("Compilation failed. Check your code for errors.","error")}catch(e){r(`Error: ${e.message}`,"error"),J("error",e)}finally{j.value=!1,C.value=!1}},G=async()=>{if(h.value){S();try{d.value=!0,x.value="Loading example...",y.value=await L("java",h.value)}catch(s){r(`Failed to load example: ${s.message}`,"error")}finally{d.value=!1,x.value=""}}},S=()=>{w.value=[],_.value=null},A=s=>{switch(s){case"error":return"text-red-400";case"success":return"text-emerald-400";case"warning":return"text-yellow-400";case"info":return"text-blue-400";default:return"text-orange-300"}},K=s=>{switch(s){case"error":return"✗";case"success":return"✓";case"warning":return"⚠";case"info":return"ℹ";default:return"›"}};se(()=>{P()}),ae(()=>{});const k=I(()=>d.value||j.value||C.value),Q=I(()=>d.value?c("tools.code-playground.java.loading").split(" ")[0]+"...":j.value?c("tools.code-playground.java.compiling"):C.value?c("tools.code-playground.java.running"):c("tools.code-playground.common.run"));return(s,e)=>{var u;return l(),o("div",ie,[t("div",ce,[t("div",ue,[t("div",de,[e[3]||(e[3]=t("svg",{class:"w-5 h-5 text-orange-400",viewBox:"0 0 128 128",fill:"currentColor"},[t("path",{d:"M47.617 98.12c-19.192 5.362 11.677 16.439 36.115 5.969-4.003-1.556-6.874-3.351-6.874-3.351-10.897 2.06-15.952 2.222-25.844 1.092-8.164-.935-3.397-3.71-3.397-3.71zm33.189-10.46c-14.444 2.779-22.787 2.69-33.354 1.6-8.171-.845-2.822-4.805-2.822-4.805-21.137 7.016 11.767 14.977 41.309 6.336-3.14-1.106-5.133-3.131-5.133-3.131zm11.319-60.575c.001 0-42.731 10.669-22.323 34.187 6.024 6.935-1.58 13.17-1.58 13.17s15.289-7.891 8.269-17.777c-6.559-9.215-11.587-13.793 15.634-29.58zm9.998 81.144s3.529 2.91-3.888 5.159c-14.102 4.272-58.706 5.56-71.095.171-4.45-1.938 3.899-4.625 6.526-5.192 2.739-.593 4.303-.485 4.303-.485-4.952-3.487-32.013 6.85-13.742 9.815 49.821 8.076 90.817-3.637 77.896-9.468zM85 77.896c2.395-1.634 5.703-3.053 5.703-3.053s-9.424 1.685-18.813 2.474c-11.494.964-23.823 1.154-30.012.326-14.652-1.959 8.033-7.348 8.033-7.348s-8.812-.596-19.644 4.644C17.455 81.134 61.958 83.958 85 77.896zm5.609 15.145c-.108.29-.468.616-.468.616 31.273-8.221 19.775-28.979 4.822-23.725-1.312.464-2 1.543-2 1.543s.829-.334 2.678-.72c7.559-1.575 18.389 10.119-5.032 22.286zM64.181 70.069c-4.614-10.429-20.26-19.553.007-35.559C89.459 14.563 76.492 1.587 76.492 1.587c5.23 20.608-18.451 26.833-26.999 39.667-5.821 8.745 2.857 18.142 14.688 28.815zm27.274 51.748c-19.187 3.612-42.854 3.191-56.887.874 0 0 2.874 2.38 17.646 3.331 22.476 1.437 57-.8 57.816-11.436.001 0-1.57 4.032-18.575 7.231z"})],-1)),e[4]||(e[4]=t("span",{class:"font-bold text-white"},"Java",-1)),b.value?(l(),o("span",pe,n(g(c)("tools.code-playground.common.ready")),1)):d.value?$("",!0):(l(),o("span",me,n(g(c)("tools.code-playground.common.not_loaded","Not loaded")),1))]),t("div",ve,[t("div",fe,[t("label",xe,n(g(c)("tools.code-playground.java.version"))+":",1),O(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),disabled:k.value||b.value,class:"px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:outline-none focus:border-orange-500 disabled:opacity-50"},[...e[5]||(e[5]=[t("option",{value:8},"Java 8",-1),t("option",{value:11},"Java 11",-1),t("option",{value:17},"Java 17",-1)])],8,ge),[[T,z.value]])]),t("div",he,[t("label",ye,n(g(c)("tools.code-playground.java.example"))+":",1),t("div",we,[O(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),onChange:G,class:"appearance-none px-2 pr-6 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:outline-none focus:border-orange-500 min-w-[120px] transition-all cursor-pointer"},[(l(!0),o(E,null,V(((u=F.value)==null?void 0:u.chapters)||[],a=>(l(),o("optgroup",{key:a.title,label:a.title},[(l(!0),o(E,null,V(a.examples||[],p=>(l(),o("option",{key:p.path,value:p.path},n(p.name),9,_e))),128))],8,be))),128))],544),[[T,h.value]]),e[6]||(e[6]=t("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))])]),t("button",{onClick:q,disabled:k.value,class:N(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",k.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white"])},[k.value?(l(),o("svg",Ce,[...e[7]||(e[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(l(),o("svg",ke,[...e[8]||(e[8]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])),oe(" "+n(Q.value),1)],10,je)])]),t("div",Je,[le(ne,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),language:"java",height:"100%",minimap:!1},null,8,["modelValue"])])]),t("div",ze,[t("div",Me,[t("div",$e,[t("span",Ee,n(g(c)("tools.code-playground.common.output")),1),_.value?(l(),o("span",Ve,n(_.value)+"ms",1)):$("",!0)]),t("button",{onClick:S,class:"text-xs text-slate-500 hover:text-white transition-colors"},n(g(c)("tools.code-playground.common.clear")),1)]),d.value?(l(),o("div",Ne,[t("div",Fe,[e[9]||(e[9]=t("div",{class:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),t("div",Se,n(x.value),1),e[10]||(e[10]=t("div",{class:"text-xs text-slate-500"},"First load may take 10-20 seconds...",-1))])])):(l(),o("div",Ae,[(l(!0),o(E,null,V(w.value,(a,p)=>(l(),o("div",{key:p,class:N(["flex items-start gap-2",A(a.type)])},[t("span",{class:N(A(a.type))},n(K(a.type)),3),t("span",Be,n(a.message),1)],2))),128)),w.value.length===0&&!d.value?(l(),o("div",Re,' Click "Run" to compile and execute Java code... ')):$("",!0)]))])])}}};export{De as default};
