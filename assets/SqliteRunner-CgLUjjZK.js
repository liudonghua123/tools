import M from"./MonacoEditor-cSfaDy0N.js";import{r as u,c as l,j as a,d as e,i as y,F as m,f as x,t as d,b as C,g as T}from"./index-DklkD_S4.js";import"./monaco-editor-CGO6wXTd.js";const A={class:"flex flex-col md:flex-row h-full"},I={class:"w-full md:w-64 h-48 md:h-full bg-slate-900 border-b md:border-b-0 md:border-r border-slate-700 flex flex-col"},U={class:"flex-1 overflow-y-auto p-2"},V={key:0,class:"text-xs text-slate-500 text-center py-4"},B={key:1,class:"text-xs text-slate-500 text-center py-4"},F={key:2,class:"space-y-1"},j={class:"flex items-center gap-2 text-slate-300 font-medium px-2 py-1 hover:bg-slate-800 rounded"},Q={class:"pl-6 space-y-0.5"},D={class:"text-slate-600"},O={class:"flex-1 flex flex-col min-w-0 h-full md:h-auto"},P={class:"h-1/2 flex flex-col border-b border-slate-700"},$={class:"flex-1 min-h-0"},J={class:"h-1/2 flex flex-col bg-slate-900 overflow-hidden"},z={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},G={class:"flex items-center gap-3"},H={key:0,class:"text-xs text-slate-500"},K={class:"flex-1 overflow-auto p-4"},W={key:0,class:"text-slate-500 italic text-sm"},X={key:0,class:"text-red-400 p-2 bg-red-900/10 rounded border border-red-900/20 text-sm font-mono"},Y={key:1,class:"text-emerald-400 p-2 text-sm"},Z={key:2,class:"overflow-x-auto"},ee={class:"w-full text-left text-sm border-collapse"},te={class:"mt-1 text-xs text-slate-500"},re={__name:"SqliteRunner",emits:["ready"],setup(se,{emit:N}){const S=N,h=u(`-- Create a table
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  email TEXT UNIQUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert data
INSERT INTO users (name, email) VALUES 
('Alice', 'alice@example.com'),
('Bob', 'bob@example.com'),
('Charlie', 'charlie@example.com');

-- Query data
SELECT * FROM users;
`),c=u([]),b=u([]),_=u(!1),g=u(!1),w=u(""),v=u(null);let i=null,E=null;const R=async()=>{if(i)return i;_.value=!0,w.value="Loading SQLite runtime...";try{const o="/tools/",t=`${o.endsWith("/")?o:o+"/"}sql-wasm/`;if(window.initSqlJs||await new Promise((s,n)=>{const r=document.createElement("script");r.src=`${t}sql-wasm.js`,r.onload=s,r.onerror=()=>n(new Error("Failed to load sql-wasm.js")),document.head.appendChild(r)}),w.value="Initializing Database...",window.initSqlJs)E=await window.initSqlJs({locateFile:s=>`${t}${s}`}),i=new E.Database,await k();else throw new Error("initSqlJs not found");return g.value=!0,S("ready"),i}catch(o){c.value=[{error:`Failed to load SQLite: ${o.message}`}],console.error(o)}finally{_.value=!1,w.value=""}},k=async()=>{if(!i)return;const o=[],t=i.exec("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'");if(t.length>0)for(const s of t[0].values){const n=s[0],r=i.exec(`PRAGMA table_info(${n})`),p=[];r.length>0&&p.push(...r[0].values.map(f=>({name:f[1],type:f[2]}))),o.push({name:n,columns:p})}b.value=o},L=async()=>{c.value=[],v.value=null,i||await R();try{const o=performance.now(),t=i.exec(h.value),s=performance.now();v.value=(s-o).toFixed(2),await k(),t.length===0?c.value=[{message:"Query executed successfully. No results returned."}]:c.value=t}catch(o){c.value=[{error:o.message}]}};return(o,t)=>(a(),l("div",A,[e("div",I,[t[2]||(t[2]=e("div",{class:"px-4 py-3 border-b border-slate-700 font-bold text-slate-300 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})]),y(" Database ")],-1)),e("div",U,[g.value?b.value.length===0?(a(),l("div",B," No tables found ")):(a(),l("div",F,[(a(!0),l(m,null,x(b.value,s=>(a(),l("div",{key:s.name,class:"text-sm"},[e("div",j,[t[1]||(t[1]=e("svg",{class:"w-3 h-3 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),y(" "+d(s.name),1)]),e("div",Q,[(a(!0),l(m,null,x(s.columns,n=>(a(),l("div",{key:n.name,class:"flex justify-between text-xs text-slate-500 px-2 py-0.5 hover:bg-slate-800/50 rounded"},[e("span",null,d(n.name),1),e("span",D,d(n.type),1)]))),128))])]))),128))])):(a(),l("div",V," No database loaded "))])]),e("div",O,[e("div",P,[e("div",{class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},[t[4]||(t[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"font-bold text-white"},"SQL Query")],-1)),e("button",{onClick:L,class:"px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2 bg-emerald-600 hover:bg-emerald-500 text-white"},[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M8 5v14l11-7z"})],-1),y(" Run ",-1)])])]),e("div",$,[C(M,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),language:"sql",theme:"vs-dark",height:"100%"},null,8,["modelValue"])])]),e("div",J,[e("div",z,[e("div",G,[t[5]||(t[5]=e("span",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},"Results",-1)),v.value?(a(),l("span",H,d(v.value)+"ms",1)):T("",!0)])]),e("div",K,[c.value.length===0?(a(),l("div",W," Run query to see results... ")):T("",!0),(a(!0),l(m,null,x(c.value,(s,n)=>(a(),l("div",{key:n,class:"mb-6 last:mb-0"},[s.error?(a(),l("div",X," Error: "+d(s.error),1)):s.message?(a(),l("div",Y,d(s.message),1)):(a(),l("div",Z,[e("table",ee,[e("thead",null,[e("tr",null,[(a(!0),l(m,null,x(s.columns,r=>(a(),l("th",{key:r,class:"bg-slate-800 p-2 border border-slate-700 text-slate-300 font-medium whitespace-nowrap"},d(r),1))),128))])]),e("tbody",null,[(a(!0),l(m,null,x(s.values,(r,p)=>(a(),l("tr",{key:p,class:"hover:bg-slate-800/30"},[(a(!0),l(m,null,x(r,(f,q)=>(a(),l("td",{key:q,class:"p-2 border border-slate-700 text-slate-400 whitespace-nowrap font-mono"},d(f===null?"NULL":f),1))),128))]))),128))])]),e("div",te,d(s.values.length)+" rows returned ",1)]))]))),128))])])])]))}};export{re as default};
