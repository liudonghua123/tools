import{_ as F}from"./monaco-editor-CGO6wXTd.js";import{r as c,o as W,l as L,c as s,j as o,u as N,a as T,d as e,h as A,g as R,t as d,e as y,q as I,F as C,f as V,n as S,i as O,b as D}from"./index-U7Fe8AEr.js";import $ from"./MonacoEditor-CQUCqJL5.js";const U={__name:"PlotCanvas",props:{image:{type:Object,required:!0}},setup(B){const p=B,u=c(null),h=()=>{const r=u.value;if(!r||!p.image)return;r.width=p.image.width,r.height=p.image.height,r.getContext("2d").drawImage(p.image,0,0)};return W(()=>{h()}),L(()=>p.image,()=>{h()}),(r,x)=>(o(),s("canvas",{ref_key:"canvasRef",ref:u,class:"max-w-full h-auto mx-auto"},null,512))}},q={class:"flex flex-col md:flex-row h-full"},G={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},J={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},K={class:"flex items-center gap-4"},Q={class:"flex items-center gap-2"},X={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},Y={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},Z=["value"],ee=["disabled"],te={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},se={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},oe={class:"flex-1 min-h-0"},ae={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900"},le={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},re={class:"flex items-center gap-3"},ne={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},ie={key:0,class:"text-xs text-slate-500"},de={key:0,class:"flex-1 flex items-center justify-center"},ce={class:"text-center space-y-4"},ue={class:"text-slate-400"},me={key:1,class:"flex-1 overflow-y-auto p-4 font-mono text-sm space-y-4"},pe={class:"space-y-1"},xe={key:0,class:"text-red-400"},ve={key:1,class:"text-emerald-400"},fe={class:"whitespace-pre-wrap"},ge={key:0,class:"text-slate-500 italic"},he={key:0,class:"border-t border-slate-700 pt-4"},we={__name:"RRunner",emits:["output","error","ready"],setup(B,{emit:p}){const{t:u}=N(),h=p,r={hello:{label:"Hello World",code:`# Basic R print
print("Hello from R!")
`},math:{label:"Basic Math & Vectors",code:`# Vector operations
x <- c(1, 2, 3, 4, 5)
print("Vector x:")
print(x)

# Mean and Standard Deviation
print("Mean:")
print(mean(x))
print("SD:")
print(sd(x))
`},dataframe:{label:"Data Frames",code:`# Creating a dataframe
df <- data.frame(
  Name = c("Alice", "Bob", "Charlie"),
  Age = c(25, 30, 35),
  Score = c(90, 85, 95)
)

print("Original DataFrame:")
print(df)

# Subset
print("People over 28:")
print(subset(df, Age > 28))
`},linear_regression:{label:"Linear Regression",code:`# Simple Linear Regression
x <- c(1, 2, 3, 4, 5)
y <- c(2, 4, 5, 4, 5)

model <- lm(y ~ x)
print("Model Summary:")
print(summary(model))
`},plotting:{label:"Plotting (Histogram)",code:`# Basic Histogram
x <- rnorm(1000)
hist(x, col="lightblue", main="Histogram of Normal Distribution")
`}},x=c("hello"),b=c(r.hello.code),m=c([]),v=c([]),i=c(!1),E=c(!1),k=c(""),_=c(null);let f=null;const M=async()=>{i.value=!0,k.value="Initializing WebR...";try{const a="/tools/",t=`${a.endsWith("/")?a:a+"/"}webr/`,{WebR:l}=await F(async()=>{const{WebR:n}=await import(`${t}webr.js`);return{WebR:n}},[]);f=new l,await f.init(),E.value=!0,h("ready")}catch(a){m.value.push({type:"error",message:`Failed to load WebR: ${a.message}`}),console.error(a)}finally{i.value=!1,k.value=""}},j=async()=>{m.value=[],v.value=[],_.value=null,f||await M();try{const a=performance.now(),t=await new f.Shelter;try{console.log(`Running R code: ${b.value}`);const n=b.value.trim(),w=await t.captureR(n);w.output.forEach(g=>{g.type==="stdout"?m.value.push({type:"log",message:g.data}):g.type==="stderr"&&m.value.push({type:"error",message:g.data})}),w.images&&w.images.length>0&&w.images.forEach(g=>{v.value.push(g)})}finally{t.purge()}const l=performance.now();_.value=(l-a).toFixed(2)}catch(a){console.error("R Execution Error:",a),m.value.push({type:"error",message:a.message||String(a)}),h("error",a)}},H=()=>{r[x.value]&&(b.value=r[x.value].code)},P=()=>{m.value=[],v.value=[],_.value=null},z=a=>a==="error"?"text-red-400":"text-emerald-400";return W(()=>{M()}),T(()=>{f&&f.destroy()}),(a,t)=>(o(),s("div",q,[e("div",G,[e("div",J,[e("div",K,[e("div",Q,[t[2]||(t[2]=e("svg",{class:"w-5 h-5 text-blue-400",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 4.5h15v15h-15z",fill:"none",stroke:"currentColor","stroke-width":"2"}),e("text",{x:"12",y:"16","text-anchor":"middle","font-size":"12","font-weight":"bold",fill:"currentColor"},"R")],-1)),t[3]||(t[3]=e("span",{class:"font-bold text-white"},"R",-1)),E.value?(o(),s("span",X,d(y(u)("tools.code-playground.common.ready")),1)):i.value?R("",!0):(o(),s("span",Y,d(y(u)("tools.code-playground.common.not_loaded")),1))]),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>x.value=l),onChange:H,class:"px-2 py-1 bg-slate-700 border border-slate-600 rounded text-slate-200 text-xs focus:outline-none focus:border-blue-500"},[(o(),s(C,null,V(r,(l,n)=>e("option",{key:n,value:n},d(l.label),9,Z)),64))],544),[[I,x.value]])]),e("button",{onClick:j,disabled:i.value,class:S(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",i.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-emerald-600 hover:bg-emerald-500 text-white"])},[i.value?(o(),s("svg",te,[...t[4]||(t[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(o(),s("svg",se,[...t[5]||(t[5]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])])),O(" "+d(i.value?"Loading...":y(u)("tools.code-playground.common.run")),1)],10,ee)]),e("div",oe,[D($,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=l=>b.value=l),language:"r",theme:"vs-dark",height:"100%",minimap:!1},null,8,["modelValue"])])]),e("div",ae,[e("div",le,[e("div",re,[e("span",ne,d(y(u)("tools.code-playground.common.output")),1),_.value?(o(),s("span",ie,d(_.value)+"ms",1)):R("",!0)]),e("button",{onClick:P,class:"text-xs text-slate-500 hover:text-white transition-colors"},d(y(u)("tools.code-playground.common.clear")),1)]),i.value?(o(),s("div",de,[e("div",ce,[t[6]||(t[6]=e("div",{class:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),e("div",ue,d(k.value),1),t[7]||(t[7]=e("div",{class:"text-xs text-slate-500"},"Initializing WebR environment...",-1))])])):(o(),s("div",me,[e("div",pe,[(o(!0),s(C,null,V(m.value,(l,n)=>(o(),s("div",{key:n,class:S(["flex items-start gap-2",z(l.type)])},[l.type==="error"?(o(),s("span",xe,"✗")):(o(),s("span",ve,"›")),e("span",fe,d(l.message),1)],2))),128)),m.value.length===0&&v.value.length===0&&!i.value?(o(),s("div",ge,' Click "Run" to execute R code... ')):R("",!0)]),v.value.length>0?(o(),s("div",he,[t[8]||(t[8]=e("h3",{class:"text-xs font-bold text-slate-400 mb-2 uppercase"},"Plots",-1)),(o(!0),s(C,null,V(v.value,(l,n)=>(o(),s("div",{key:n,class:"bg-white rounded p-1 mb-2"},[D(U,{image:l},null,8,["image"])]))),128))])):R("",!0)]))])]))}};export{we as default};
