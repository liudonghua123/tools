import{_ as N,u as $,r as u,o as D,a as I,c as n,j as r,d as t,h as S,q as W,F as z,f as E,t as p,e as y,n as H,i as q,b as O,g as G}from"./index-DkX3DOGW.js";import J from"./MonacoEditor-DRPUyzCI.js";import{f as K,a as L}from"./ExampleLoader-C0CuCz3g.js";import{x as P,a as Q}from"./xterm-Btcyv0ds.js";import"./monaco-editor-DrHUTMTD.js";const X={class:"flex flex-col md:flex-row h-full"},Y={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-slate-700"},Z={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700 bg-slate-800/50"},ee={class:"flex items-center gap-2"},te={class:"relative group ml-2"},ae=["label"],se=["value"],le={key:0,class:"text-xs px-2 py-0.5 bg-emerald-600 text-white rounded-full"},oe={key:1,class:"text-xs px-2 py-0.5 bg-slate-600 text-slate-300 rounded-full"},ne=["disabled"],re={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ie={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},de={class:"flex-1 min-h-0"},ue={class:"w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-slate-900 border-t md:border-t-0 md:border-l border-slate-700"},ce={class:"flex items-center justify-between px-4 py-3 border-b border-slate-700"},pe={class:"flex items-center gap-3"},me={class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},fe={key:0,class:"text-xs text-slate-500"},ve={class:"flex-1 min-h-0 p-2 bg-[#0f172a]"},xe={__name:"CppRunner",emits:["output","error","ready"],setup(he,{emit:F}){const{t:b}=$(),U=F,f=u(""),k=u(null),v=u(""),s=u(!1),x=u(!1),h=u(null),i=u(""),V=async()=>{try{const a=await K("cpp");if(k.value=a,a.chapters&&a.chapters.length>0&&a.chapters[0].examples.length>0){const e=a.chapters[0].examples[0];v.value=e.path,f.value=await L("cpp",e.path)}}catch(a){console.error("Failed to load C++ manifest:",a)}};let c=null,l=null,g=null;const C=u(null),R=()=>{l=new P.Terminal({cursorBlink:!0,fontSize:14,fontFamily:'Menlo, Monaco, "Courier New", monospace',theme:{background:"#0f172a",foreground:"#e2e8f0"}}),g=new Q.FitAddon,l.loadAddon(g),l.open(C.value),g.fit(),l.write(`\x1B[38;5;244mResult will appear here...\x1B[0m\r
`)},T=async()=>{s.value=!0,i.value="Initializing C++ environment...";try{const a="/tools/",e=`${a.endsWith("/")?a:a+"/"}wasm-clang/worker.js`;c=new Worker(e),c.onmessage=o=>{const{id:d,data:_}=o.data;if(d==="write"){const w=_.replace(/\n/g,`\r
`);l.write(w)}};const m=new MessageChannel;m.port1.onmessage=o=>{const{id:d,data:_}=o.data;if(d==="write"){const w=_;if(w.includes("Untarring sysroot.tar")){i.value="Unpacking system files...";return}if(i.value==="Unpacking system files..."&&w.includes("done")){i.value="",x.value=!0,s.value=!1,U("ready");return}l.write(w.replace(/\n/g,`\r
`))}},c.postMessage({id:"constructor",data:m.port2},[m.port2])}catch(a){i.value=`Failed to load C++ environment: ${a.message}`,s.value=!1,console.error(a)}},j=async()=>{if(!c||!x.value)return;s.value=!0,i.value="Compiling and running...",l.clear(),h.value=null;const a=performance.now();try{c.postMessage({id:"compileLinkRun",data:f.value}),setTimeout(()=>{s.value=!1;const e=performance.now();h.value=(e-a).toFixed(2)},1e3)}catch(e){l.write(`\x1B[31mError: ${e.message}\x1B[0m\r
`),s.value=!1}},A=async()=>{if(v.value){M();try{s.value=!0,i.value="Loading example...",f.value=await L("cpp",v.value)}catch(a){l.write(`\x1B[31mFailed to load example: ${a.message}\x1B[0m\r
`)}finally{s.value=!1,i.value=""}}},M=()=>{l.clear(),h.value=null};D(async()=>{R(),await T(),V(),window.addEventListener("resize",B)}),I(()=>{c&&c.terminate(),l&&l.dispose(),window.removeEventListener("resize",B)});const B=()=>{g&&g.fit()};return(a,e)=>{var m;return r(),n("div",X,[t("div",Y,[t("div",Z,[t("div",ee,[e[3]||(e[3]=t("svg",{class:"w-5 h-5 text-blue-500",viewBox:"0 0 128 128",fill:"currentColor"},[t("path",{d:"M117.513 18.355l-3.235-5.603a11.536 11.536 0 00-15.75-4.22L61.642 29.83a48.27 48.27 0 00-6.04-2.858C45.335 23.367 33.91 22.067 23.778 27.915a39.22 39.22 0 00-14.35 14.35C3.58 52.56.98 64.122.98 75.83 1.012 101.48 18.67 119.106 43.687 119.106a44.6 44.6 0 0021.782-5.462l33.868 19.553a11.536 11.536 0 0015.75-4.22l3.235-5.604a11.536 11.536 0 00-4.22-15.75L78.68 87.21a48.514 48.514 0 002.822-5.594c3.483-8.491 3.515-18.064-.096-26.471a41.05 41.05 0 00-2.858-6.04l34.744-20.06a11.536 11.536 0 004.22-14.89zM52.022 93.9c-4.992 2.883-11.233 2.915-16.193.096a18.279 18.279 0 01-6.666-6.666c-2.787-4.832-2.787-10.724 0-15.556a18.279 18.279 0 016.666-6.666c4.96-2.819 11.2-2.819 16.193.064a18.279 18.279 0 016.666 6.666c2.787 4.832 2.819 10.724.032 15.556a18.441 18.441 0 01-6.698 6.506zm37.28-3.048l-1.636 2.822a1.868 1.868 0 01-2.532.61L30.133 63.385l1.603-2.822a1.868 1.868 0 012.532-.61l55.034 31.796a1.83 1.83 0 01.61 1.636l-.61 1.25c-.21.21-.42.42-.61.61h-.61l-.61-2.918zm14.89-25.922a1.868 1.868 0 01-.61 2.532l-55.034 31.796-1.503-2.612a1.868 1.868 0 01.61-2.532l55.034-31.796a1.83 1.83 0 01.61.61l.894 1.15-.001.864z"})],-1)),e[4]||(e[4]=t("span",{class:"font-bold text-white"},"C/C++",-1)),t("div",te,[S(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>v.value=o),onChange:A,class:"appearance-none bg-slate-700/50 border border-slate-600 text-slate-200 text-xs rounded px-2 pr-6 py-1 hover:border-slate-500 focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all cursor-pointer"},[(r(!0),n(z,null,E((m=k.value)==null?void 0:m.chapters,o=>(r(),n("optgroup",{key:o.title,label:o.title},[(r(!0),n(z,null,E(o.examples,d=>(r(),n("option",{key:d.path,value:d.path},p(d.name),9,se))),128))],8,ae))),128))],544),[[W,v.value]]),e[2]||(e[2]=t("div",{class:"absolute inset-y-0 right-1.5 flex items-center pointer-events-none text-slate-400"},[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),x.value?(r(),n("span",le,p(y(b)("tools.code-playground.common.ready")),1)):(r(),n("span",oe,p(i.value||"Loading..."),1))]),t("button",{onClick:j,disabled:s.value||!x.value,class:H(["px-4 py-1.5 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",s.value||!x.value?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white"])},[s.value?(r(),n("svg",re,[...e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(r(),n("svg",ie,[...e[6]||(e[6]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])),q(" "+p(s.value?"Running...":y(b)("tools.code-playground.common.run")),1)],10,ne)]),t("div",de,[O(J,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value=o),language:"cpp",theme:"vs-dark",height:"100%",minimap:!1},null,8,["modelValue"])])]),t("div",ue,[t("div",ce,[t("div",pe,[t("span",me,p(y(b)("tools.code-playground.common.output")),1),h.value?(r(),n("span",fe,p(h.value)+"ms",1)):G("",!0)]),t("button",{onClick:M,class:"text-xs text-slate-500 hover:text-white transition-colors"},p(y(b)("tools.code-playground.common.clear")),1)]),t("div",ve,[t("div",{ref_key:"terminalContainer",ref:C,class:"w-full h-full"},null,512)])])])}}},ke=N(xe,[["__scopeId","data-v-92244f43"]]);export{ke as default};
